

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>core package &mdash; PySegCNN  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="main package" href="main.html" />
    <link rel="prev" title="pysegcnn" href="modules.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> PySegCNN
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">pysegcnn</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">core package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.cli">core.cli module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#license">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.constants">core.constants module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.dataset">core.dataset module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id2">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.graphics">core.graphics module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id4">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.layers">core.layers module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.logging">core.logging module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id6">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.models">core.models module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id7">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.predict">core.predict module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id8">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.split">core.split module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id9">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.trainer">core.trainer module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id10">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.transforms">core.transforms module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id11">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core.utils">core.utils module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id12">License</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-core">Module contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="main.html">main package</a></li>
<li class="toctree-l2"><a class="reference internal" href="preprocessing.html">preprocessing package</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">PySegCNN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="modules.html">pysegcnn</a> &raquo;</li>
        
      <li>core package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/source/core.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="core-package">
<h1>core package<a class="headerlink" href="#core-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-core.cli">
<span id="core-cli-module"></span><h2>core.cli module<a class="headerlink" href="#module-core.cli" title="Permalink to this headline">¶</a></h2>
<p>Command line interface parsers.</p>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py function">
<dt id="core.cli.structure_parser">
<code class="sig-prename descclassname">core.cli.</code><code class="sig-name descname">structure_parser</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/cli.html#structure_parser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.cli.structure_parser" title="Permalink to this definition">¶</a></dt>
<dd><p>Command line argument parser to standardize dataset structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-core.constants">
<span id="core-constants-module"></span><h2>core.constants module<a class="headerlink" href="#module-core.constants" title="Permalink to this headline">¶</a></h2>
<p>A collection of constant values.</p>
<div class="section" id="id1">
<h3>License<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py class">
<dt id="core.constants.Cloud95Labels">
<em class="property">class </em><code class="sig-prename descclassname">core.constants.</code><code class="sig-name descname">Cloud95Labels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/constants.html#Cloud95Labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.constants.Cloud95Labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.constants.Label" title="core.constants.Label"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.constants.Label</span></code></a></p>
<p>Class labels of the <a class="reference external" href="https://github.com/SorourMo/95-Cloud-An-Extension-to-38-Cloud-Dataset">Cloud-95</a> dataset.</p>
<dl class="py attribute">
<dt id="core.constants.Cloud95Labels.Clear">
<code class="sig-name descname">Clear</code><em class="property"> = (0, 'skyblue')</em><a class="headerlink" href="#core.constants.Cloud95Labels.Clear" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Cloud95Labels.Cloud">
<code class="sig-name descname">Cloud</code><em class="property"> = (1, 'white')</em><a class="headerlink" href="#core.constants.Cloud95Labels.Cloud" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.constants.Label">
<em class="property">class </em><code class="sig-prename descclassname">core.constants.</code><code class="sig-name descname">Label</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/constants.html#Label"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.constants.Label" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Generic enumeration for class labels.</p>
<dl class="py method">
<dt id="core.constants.Label.color">
<em class="property">property </em><code class="sig-name descname">color</code><a class="headerlink" href="#core.constants.Label.color" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the color to plot a class.</p>
</dd></dl>

<dl class="py method">
<dt id="core.constants.Label.id">
<em class="property">property </em><code class="sig-name descname">id</code><a class="headerlink" href="#core.constants.Label.id" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value of a class in the ground truth.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.constants.Landsat8">
<em class="property">class </em><code class="sig-prename descclassname">core.constants.</code><code class="sig-name descname">Landsat8</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/constants.html#Landsat8"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.constants.Landsat8" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>The spectral bands of the Landsat 8 sensors.</p>
<dl class="simple">
<dt>sensors:</dt><dd><ul class="simple">
<li><p>Operational Land Imager (OLI), (bands 1-9)</p></li>
<li><p>Thermal Infrared Sensor (TIRS), (bands 10, 11)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt id="core.constants.Landsat8.blue">
<code class="sig-name descname">blue</code><em class="property"> = 2</em><a class="headerlink" href="#core.constants.Landsat8.blue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.cirrus">
<code class="sig-name descname">cirrus</code><em class="property"> = 9</em><a class="headerlink" href="#core.constants.Landsat8.cirrus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.green">
<code class="sig-name descname">green</code><em class="property"> = 3</em><a class="headerlink" href="#core.constants.Landsat8.green" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.nir">
<code class="sig-name descname">nir</code><em class="property"> = 5</em><a class="headerlink" href="#core.constants.Landsat8.nir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.pan">
<code class="sig-name descname">pan</code><em class="property"> = 8</em><a class="headerlink" href="#core.constants.Landsat8.pan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.red">
<code class="sig-name descname">red</code><em class="property"> = 4</em><a class="headerlink" href="#core.constants.Landsat8.red" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.swir1">
<code class="sig-name descname">swir1</code><em class="property"> = 6</em><a class="headerlink" href="#core.constants.Landsat8.swir1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.swir2">
<code class="sig-name descname">swir2</code><em class="property"> = 7</em><a class="headerlink" href="#core.constants.Landsat8.swir2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.tir1">
<code class="sig-name descname">tir1</code><em class="property"> = 10</em><a class="headerlink" href="#core.constants.Landsat8.tir1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Landsat8.violet">
<code class="sig-name descname">violet</code><em class="property"> = 1</em><a class="headerlink" href="#core.constants.Landsat8.violet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.constants.ProSnowLabels">
<em class="property">class </em><code class="sig-prename descclassname">core.constants.</code><code class="sig-name descname">ProSnowLabels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/constants.html#ProSnowLabels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.constants.ProSnowLabels" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.constants.Label" title="core.constants.Label"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.constants.Label</span></code></a></p>
<p>Class labels of the ProSnow datasets.</p>
<dl class="py attribute">
<dt id="core.constants.ProSnowLabels.Cloud">
<code class="sig-name descname">Cloud</code><em class="property"> = (0, 'white')</em><a class="headerlink" href="#core.constants.ProSnowLabels.Cloud" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.ProSnowLabels.Snow">
<code class="sig-name descname">Snow</code><em class="property"> = (1, 'lightblue')</em><a class="headerlink" href="#core.constants.ProSnowLabels.Snow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.ProSnowLabels.Snow_free">
<code class="sig-name descname">Snow_free</code><em class="property"> = (2, 'sienna')</em><a class="headerlink" href="#core.constants.ProSnowLabels.Snow_free" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.constants.Sentinel2">
<em class="property">class </em><code class="sig-prename descclassname">core.constants.</code><code class="sig-name descname">Sentinel2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/constants.html#Sentinel2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.constants.Sentinel2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>The spectral bands of the Sentinel-2 MultiSpectral Instrument (MSI).</p>
<dl class="py attribute">
<dt id="core.constants.Sentinel2.aerosol">
<code class="sig-name descname">aerosol</code><em class="property"> = 1</em><a class="headerlink" href="#core.constants.Sentinel2.aerosol" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.blue">
<code class="sig-name descname">blue</code><em class="property"> = 2</em><a class="headerlink" href="#core.constants.Sentinel2.blue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.cirrus">
<code class="sig-name descname">cirrus</code><em class="property"> = 10</em><a class="headerlink" href="#core.constants.Sentinel2.cirrus" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.green">
<code class="sig-name descname">green</code><em class="property"> = 3</em><a class="headerlink" href="#core.constants.Sentinel2.green" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.nir">
<code class="sig-name descname">nir</code><em class="property"> = 8</em><a class="headerlink" href="#core.constants.Sentinel2.nir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.nnir">
<code class="sig-name descname">nnir</code><em class="property"> = '8A'</em><a class="headerlink" href="#core.constants.Sentinel2.nnir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.red">
<code class="sig-name descname">red</code><em class="property"> = 4</em><a class="headerlink" href="#core.constants.Sentinel2.red" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.swir1">
<code class="sig-name descname">swir1</code><em class="property"> = 11</em><a class="headerlink" href="#core.constants.Sentinel2.swir1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.swir2">
<code class="sig-name descname">swir2</code><em class="property"> = 12</em><a class="headerlink" href="#core.constants.Sentinel2.swir2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.vapor">
<code class="sig-name descname">vapor</code><em class="property"> = 9</em><a class="headerlink" href="#core.constants.Sentinel2.vapor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.vnir1">
<code class="sig-name descname">vnir1</code><em class="property"> = 5</em><a class="headerlink" href="#core.constants.Sentinel2.vnir1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.vnir2">
<code class="sig-name descname">vnir2</code><em class="property"> = 6</em><a class="headerlink" href="#core.constants.Sentinel2.vnir2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.Sentinel2.vnir3">
<code class="sig-name descname">vnir3</code><em class="property"> = 7</em><a class="headerlink" href="#core.constants.Sentinel2.vnir3" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.constants.SparcsLabels">
<em class="property">class </em><code class="sig-prename descclassname">core.constants.</code><code class="sig-name descname">SparcsLabels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/constants.html#SparcsLabels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.constants.SparcsLabels" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.constants.Label" title="core.constants.Label"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.constants.Label</span></code></a></p>
<p>Class labels of the <a class="reference external" href="https://www.usgs.gov/land-resources/nli/landsat/spatial-procedures-automated-removal-cloud-and-shadow-sparcs-validation">Sparcs</a> dataset.</p>
<dl class="py attribute">
<dt id="core.constants.SparcsLabels.Cloud">
<code class="sig-name descname">Cloud</code><em class="property"> = (5, 'white')</em><a class="headerlink" href="#core.constants.SparcsLabels.Cloud" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.SparcsLabels.Flooded">
<code class="sig-name descname">Flooded</code><em class="property"> = (6, 'yellow')</em><a class="headerlink" href="#core.constants.SparcsLabels.Flooded" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.SparcsLabels.Land">
<code class="sig-name descname">Land</code><em class="property"> = (4, 'sienna')</em><a class="headerlink" href="#core.constants.SparcsLabels.Land" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.SparcsLabels.Shadow">
<code class="sig-name descname">Shadow</code><em class="property"> = (0, 'grey')</em><a class="headerlink" href="#core.constants.SparcsLabels.Shadow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.SparcsLabels.Shadow_over_water">
<code class="sig-name descname">Shadow_over_water</code><em class="property"> = (1, 'darkblue')</em><a class="headerlink" href="#core.constants.SparcsLabels.Shadow_over_water" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.SparcsLabels.Snow">
<code class="sig-name descname">Snow</code><em class="property"> = (3, 'lightblue')</em><a class="headerlink" href="#core.constants.SparcsLabels.Snow" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.constants.SparcsLabels.Water">
<code class="sig-name descname">Water</code><em class="property"> = (2, 'blue')</em><a class="headerlink" href="#core.constants.SparcsLabels.Water" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-core.dataset">
<span id="core-dataset-module"></span><h2>core.dataset module<a class="headerlink" href="#module-core.dataset" title="Permalink to this headline">¶</a></h2>
<p>Custom dataset classes compliant to the PyTorch standard.</p>
<p>Each custom dataset should inherit from torch.utils.data.Dataset to benefit
from the torch.utils.data.DataLoader class, which implements helpful utilities
during model training.</p>
<p>For any kind of image-like dataset, inherit the ImageDataset class to create
your custom dataset.</p>
<div class="section" id="id2">
<h3>License<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py class">
<dt id="core.dataset.Cloud95Dataset">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">Cloud95Dataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">use_bands</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gt_pattern</span><span class="o">=</span><span class="default_value">'(.*)gt\\.tif'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transforms</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#Cloud95Dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.Cloud95Dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.dataset.ImageDataset" title="core.dataset.ImageDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.dataset.ImageDataset</span></code></a></p>
<p>Class for the <a class="reference external" href="https://github.com/SorourMo/95-Cloud-An-Extension-to-38-Cloud-Dataset">Cloud-95</a> dataset by <a class="reference external" href="https://arxiv.org/abs/2001.08768">Mohajerani et al. (2020)</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_dir</strong> (<cite>str</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of the spectral bands to use. The default is [].</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite> or <cite>None</cite>, optional) – The size of the tiles. If not <cite>None</cite>, each scene is divided into square
tiles of shape (tile_size, tile_size). The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>, optional) – A regural expression to match the ground truth naming convention. All
directories and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for files
matching <code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>. The default is ‘(.*)gt\.tif’.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_samples</span></code>(scene)</p></td>
<td><p>Stack the bands of a sample in a single array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.Cloud95Dataset.compose_scenes" title="core.dataset.Cloud95Dataset.compose_scenes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compose_scenes</span></code></a>()</p></td>
<td><p>Build the list of samples of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.Cloud95Dataset.get_labels" title="core.dataset.Cloud95Dataset.get_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code></a>()</p></td>
<td><p>Class labels of the Cloud-95 dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.Cloud95Dataset.get_sensor" title="core.dataset.Cloud95Dataset.get_sensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sensor</span></code></a>()</p></td>
<td><p>Landsat 8 bands of the Cloud-95 dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.Cloud95Dataset.get_size" title="core.dataset.Cloud95Dataset.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a>()</p></td>
<td><p>Image size of the Cloud-95 dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.Cloud95Dataset.parse_scene_id" title="core.dataset.Cloud95Dataset.parse_scene_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_scene_id</span></code></a>(scene_id)</p></td>
<td><p>Parse Sparcs scene identifiers (Landsat 8).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.Cloud95Dataset.preprocess" title="core.dataset.Cloud95Dataset.preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code></a>(data, gt)</p></td>
<td><p>Preprocess Cloud-95 dataset images.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_scene</span></code>(idx)</p></td>
<td><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tensor</span></code>(x, dtype)</p></td>
<td><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.dataset.Cloud95Dataset.compose_scenes">
<code class="sig-name descname">compose_scenes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#Cloud95Dataset.compose_scenes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.Cloud95Dataset.compose_scenes" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the list of samples of the dataset.</p>
<p>Each sample is represented by a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>scenes</strong> –</p>
<dl class="simple">
<dt>Each item in <code class="docutils literal notranslate"><span class="pre">scenes</span></code> is a <cite>dict</cite> with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_1'</span></code></dt><dd><p>Path to the file of band_1.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_2'</span></code></dt><dd><p>Path to the file of band_2.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_n'</span></code></dt><dd><p>Path to the file of band_n.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'gt'</span></code></dt><dd><p>Path to the ground truth file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'date'</span></code></dt><dd><p>The date of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tile'</span></code></dt><dd><p>The tile id of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'transform'</span></code></dt><dd><p>The transformation to apply.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'id'</span></code></dt><dd><p>The scene identifier.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>list</cite> [<cite>dict</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.Cloud95Dataset.get_labels">
<code class="sig-name descname">get_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#Cloud95Dataset.get_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.Cloud95Dataset.get_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Class labels of the Cloud-95 dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>labels</strong> – The class labels.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.Cloud95Dataset.get_sensor">
<code class="sig-name descname">get_sensor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#Cloud95Dataset.get_sensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.Cloud95Dataset.get_sensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Landsat 8 bands of the Cloud-95 dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>sensor</strong> – An enumeration of the bands of the sensor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.Cloud95Dataset.get_size">
<code class="sig-name descname">get_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#Cloud95Dataset.get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.Cloud95Dataset.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Image size of the Cloud-95 dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>size</strong> – The image size (height, width).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>tuple</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.Cloud95Dataset.parse_scene_id">
<code class="sig-name descname">parse_scene_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#Cloud95Dataset.parse_scene_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.Cloud95Dataset.parse_scene_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse Sparcs scene identifiers (Landsat 8).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene_id</strong> (<cite>str</cite>) – A scene identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scene</strong> – A dictionary containing scene metadata. If <cite>None</cite>, <code class="docutils literal notranslate"><span class="pre">scene_id</span></code> is
not a valid Landsat scene identifier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite> or <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.Cloud95Dataset.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">gt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#Cloud95Dataset.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.Cloud95Dataset.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess Cloud-95 dataset images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The sample input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The sample ground truth.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The preprocessed input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The preprocessed ground truth data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.dataset.ImageDataset">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">ImageDataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">use_bands</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gt_pattern</span><span class="o">=</span><span class="default_value">'(.*)gt.tif'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transforms</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Dataset</span></code></p>
<p>Base class for multispectral image data.</p>
<p>Inheriting from <cite>torch.utils.data.Dataset</cite> to be compliant to the PyTorch
standard. Furthermore, using instances of <cite>torch.utils.data.Dataset</cite>
enables the use of the handy <cite>torch.utils.data.DataLoader</cite> class during
model training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_dir</strong> (<cite>str</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of the spectral bands to use. The default is [].</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite> or <cite>None</cite>, optional) – The size of the tiles. If not <cite>None</cite>, each scene is divided into square
tiles of shape (tile_size, tile_size). The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>, optional) – A regural expression to match the ground truth naming convention.
All directories and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for
files matching <code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>. The default is ‘(.*)gt\.tif’.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.build_samples" title="core.dataset.ImageDataset.build_samples"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_samples</span></code></a>(scene)</p></td>
<td><p>Stack the bands of a sample in a single array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.compose_scenes" title="core.dataset.ImageDataset.compose_scenes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compose_scenes</span></code></a>()</p></td>
<td><p>Build the list of samples of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.get_labels" title="core.dataset.ImageDataset.get_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code></a>()</p></td>
<td><p>Return an enumeration of the class labels of the dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.get_sensor" title="core.dataset.ImageDataset.get_sensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sensor</span></code></a>()</p></td>
<td><p>Return an enumeration of the bands of the sensor of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.get_size" title="core.dataset.ImageDataset.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a>()</p></td>
<td><p>Return the size of the images in the dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.parse_scene_id" title="core.dataset.ImageDataset.parse_scene_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_scene_id</span></code></a>(scene_id)</p></td>
<td><p>Parse the scene identifier.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.preprocess" title="core.dataset.ImageDataset.preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code></a>(data, gt)</p></td>
<td><p>Preprocess a sample before feeding it to a model.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.read_scene" title="core.dataset.ImageDataset.read_scene"><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_scene</span></code></a>(idx)</p></td>
<td><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ImageDataset.to_tensor" title="core.dataset.ImageDataset.to_tensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tensor</span></code></a>(x, dtype)</p></td>
<td><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.dataset.ImageDataset.build_samples">
<code class="sig-name descname">build_samples</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.build_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.build_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack the bands of a sample in a single array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene</strong> (<cite>dict</cite>) – <dl class="simple">
<dt>The sample data dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_1'</span></code></dt><dd><p>data of band_1 (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_2'</span></code></dt><dd><p>data of band_2 (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_n'</span></code></dt><dd><p>data of band_n (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'gt'</span></code></dt><dd><p>data of the ground truth (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'date'</span></code></dt><dd><p>The date of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tile'</span></code></dt><dd><p>The tile id of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'transform'</span></code></dt><dd><p>The transformation to apply.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'id'</span></code></dt><dd><p>The scene identifier.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>stack</strong> (<cite>numpy.ndarray</cite>) – The input data of the sample.</p></li>
<li><p><strong>gt</strong> (<em>TYPE</em>) – The ground truth of the sample.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.compose_scenes">
<code class="sig-name descname">compose_scenes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.compose_scenes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.compose_scenes" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the list of samples of the dataset.</p>
<p>Each sample is represented by a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if the <cite>pysegcnn.core.dataset.ImageDataset</cite> class is not
inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>samples</strong> –</p>
<dl class="simple">
<dt>Each dictionary representing a sample should have keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_1'</span></code></dt><dd><p>Path to the file of band_1.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_2'</span></code></dt><dd><p>Path to the file of band_2.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_n'</span></code></dt><dd><p>Path to the file of band_n.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'gt'</span></code></dt><dd><p>Path to the ground truth file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'date'</span></code></dt><dd><p>The date of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tile'</span></code></dt><dd><p>The tile id of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'transform'</span></code></dt><dd><p>The transformation to apply.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'id'</span></code></dt><dd><p>The scene identifier.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite> [<cite>dict</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.get_labels">
<code class="sig-name descname">get_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.get_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.get_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an enumeration of the class labels of the dataset.</p>
<p>Examples can be found in <cite>pysegcnn.core.constants</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if the <cite>pysegcnn.core.dataset.ImageDataset</cite> class is not
inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>labels</strong> – The class labels.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.get_sensor">
<code class="sig-name descname">get_sensor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.get_sensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.get_sensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an enumeration of the bands of the sensor of the dataset.</p>
<p>Examples can be found in <cite>pysegcnn.core.constants</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if the <cite>pysegcnn.core.dataset.ImageDataset</cite> class is not
inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sensor</strong> – An enumeration of the bands of the sensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.get_size">
<code class="sig-name descname">get_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the size of the images in the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if the <cite>pysegcnn.core.dataset.ImageDataset</cite> class is not
inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>size</strong> – The image size (height, width).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>tuple</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.parse_scene_id">
<code class="sig-name descname">parse_scene_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.parse_scene_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.parse_scene_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the scene identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene_id</strong> (<cite>str</cite>) – A scene identifier.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Raised if the <cite>pysegcnn.core.dataset.ImageDataset</cite> class is not
inherited.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>scene</strong> – A dictionary containing scene metadata. If <cite>None</cite>, <code class="docutils literal notranslate"><span class="pre">scene_id</span></code> is
not a valid scene identifier.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite> or <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">gt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess a sample before feeding it to a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The sample input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The sample ground truth.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Raised if the <cite>pysegcnn.core.dataset.ImageDataset</cite> class is not
inherited.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The preprocessed input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The preprocessed ground truth data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.read_scene">
<code class="sig-name descname">read_scene</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.read_scene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.read_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>idx</strong> (<cite>int</cite>) – The index of the sample.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>scene_data</strong> –</p>
<dl class="simple">
<dt>The sample data dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_1'</span></code></dt><dd><p>data of band_1 (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_2'</span></code></dt><dd><p>data of band_2 (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_n'</span></code></dt><dd><p>data of band_n (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'gt'</span></code></dt><dd><p>data of the ground truth (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'date'</span></code></dt><dd><p>The date of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tile'</span></code></dt><dd><p>The tile id of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'transform'</span></code></dt><dd><p>The transformation to apply.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'id'</span></code></dt><dd><p>The scene identifier.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ImageDataset.to_tensor">
<code class="sig-name descname">to_tensor</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">dtype</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ImageDataset.to_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ImageDataset.to_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – The input data.</p></li>
<li><p><strong>dtype</strong> (<cite>torch.dtype</cite>) – The data type used to convert <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – The input data tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.dataset.ProSnowDataset">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">ProSnowDataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">use_bands</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gt_pattern</span><span class="o">=</span><span class="default_value">'(.*)gt\\.tif'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transforms</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.dataset.StandardEoDataset" title="core.dataset.StandardEoDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.dataset.StandardEoDataset</span></code></a></p>
<p>Class for the ProSnow datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_dir</strong> (<cite>str</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of the spectral bands to use. The default is [].</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite> or <cite>None</cite>, optional) – The size of the tiles. If not <cite>None</cite>, each scene is divided into square
tiles of shape (tile_size, tile_size). The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>, optional) – A regural expression to match the ground truth naming convention. All
directories and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for files
matching <code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>. The default is ‘(.*)gt\.tif’.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_samples</span></code>(scene)</p></td>
<td><p>Stack the bands of a sample in a single array.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compose_scenes</span></code>()</p></td>
<td><p>Build the list of samples of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ProSnowDataset.get_labels" title="core.dataset.ProSnowDataset.get_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code></a>()</p></td>
<td><p>Class labels of the ProSnow datasets.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.ProSnowDataset.get_sensor" title="core.dataset.ProSnowDataset.get_sensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sensor</span></code></a>()</p></td>
<td><p>Sentinel 2 bands of the ProSnow datasets.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code>()</p></td>
<td><p>Return the size of the images in the dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.ProSnowDataset.parse_scene_id" title="core.dataset.ProSnowDataset.parse_scene_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_scene_id</span></code></a>(scene_id)</p></td>
<td><p>Parse ProSnow scene identifiers (Sentinel 2).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ProSnowDataset.preprocess" title="core.dataset.ProSnowDataset.preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code></a>(data, gt)</p></td>
<td><p>Preprocess ProSnow dataset images.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_scene</span></code>(idx)</p></td>
<td><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tensor</span></code>(x, dtype)</p></td>
<td><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.dataset.ProSnowDataset.get_labels">
<code class="sig-name descname">get_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowDataset.get_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowDataset.get_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Class labels of the ProSnow datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>labels</strong> – The class labels.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ProSnowDataset.get_sensor">
<code class="sig-name descname">get_sensor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowDataset.get_sensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowDataset.get_sensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Sentinel 2 bands of the ProSnow datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>sensor</strong> – An enumeration of the bands of the sensor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ProSnowDataset.parse_scene_id">
<code class="sig-name descname">parse_scene_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowDataset.parse_scene_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowDataset.parse_scene_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse ProSnow scene identifiers (Sentinel 2).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene_id</strong> (<cite>str</cite>) – A scene identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scene</strong> – A dictionary containing scene metadata. If <cite>None</cite>, <code class="docutils literal notranslate"><span class="pre">scene_id</span></code> is
not a valid Sentinel-2 scene identifier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite> or <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.ProSnowDataset.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">gt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowDataset.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowDataset.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess ProSnow dataset images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The sample input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The sample ground truth.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The preprocessed input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The preprocessed ground truth data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.dataset.ProSnowGarmisch">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">ProSnowGarmisch</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">use_bands</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gt_pattern</span><span class="o">=</span><span class="default_value">'(.*)gt\\.tif'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transforms</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowGarmisch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowGarmisch" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.dataset.ProSnowDataset" title="core.dataset.ProSnowDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.dataset.ProSnowDataset</span></code></a></p>
<p>Class for the ProSnow Garmisch dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_dir</strong> (<cite>str</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of the spectral bands to use. The default is [].</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite> or <cite>None</cite>, optional) – The size of the tiles. If not <cite>None</cite>, each scene is divided into square
tiles of shape (tile_size, tile_size). The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>, optional) – A regural expression to match the ground truth naming convention. All
directories and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for files
matching <code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>. The default is ‘(.*)gt\.tif’.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_samples</span></code>(scene)</p></td>
<td><p>Stack the bands of a sample in a single array.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compose_scenes</span></code>()</p></td>
<td><p>Build the list of samples of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code>()</p></td>
<td><p>Class labels of the ProSnow datasets.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sensor</span></code>()</p></td>
<td><p>Sentinel 2 bands of the ProSnow datasets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ProSnowGarmisch.get_size" title="core.dataset.ProSnowGarmisch.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a>()</p></td>
<td><p>Image size of the ProSnow Garmisch dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_scene_id</span></code>(scene_id)</p></td>
<td><p>Parse ProSnow scene identifiers (Sentinel 2).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code>(data, gt)</p></td>
<td><p>Preprocess ProSnow dataset images.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_scene</span></code>(idx)</p></td>
<td><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tensor</span></code>(x, dtype)</p></td>
<td><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.dataset.ProSnowGarmisch.get_size">
<code class="sig-name descname">get_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowGarmisch.get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowGarmisch.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Image size of the ProSnow Garmisch dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>size</strong> – The image size (height, width).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>tuple</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.dataset.ProSnowObergurgl">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">ProSnowObergurgl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">use_bands</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gt_pattern</span><span class="o">=</span><span class="default_value">'(.*)gt\\.tif'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transforms</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowObergurgl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowObergurgl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.dataset.ProSnowDataset" title="core.dataset.ProSnowDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.dataset.ProSnowDataset</span></code></a></p>
<p>Class for the ProSnow Obergurgl dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_dir</strong> (<cite>str</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of the spectral bands to use. The default is [].</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite> or <cite>None</cite>, optional) – The size of the tiles. If not <cite>None</cite>, each scene is divided into square
tiles of shape (tile_size, tile_size). The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>, optional) – A regural expression to match the ground truth naming convention. All
directories and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for files
matching <code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>. The default is ‘(.*)gt\.tif’.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_samples</span></code>(scene)</p></td>
<td><p>Stack the bands of a sample in a single array.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compose_scenes</span></code>()</p></td>
<td><p>Build the list of samples of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code>()</p></td>
<td><p>Class labels of the ProSnow datasets.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sensor</span></code>()</p></td>
<td><p>Sentinel 2 bands of the ProSnow datasets.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.ProSnowObergurgl.get_size" title="core.dataset.ProSnowObergurgl.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a>()</p></td>
<td><p>Image size of the ProSnow Obergurgl dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_scene_id</span></code>(scene_id)</p></td>
<td><p>Parse ProSnow scene identifiers (Sentinel 2).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code>(data, gt)</p></td>
<td><p>Preprocess ProSnow dataset images.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_scene</span></code>(idx)</p></td>
<td><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tensor</span></code>(x, dtype)</p></td>
<td><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.dataset.ProSnowObergurgl.get_size">
<code class="sig-name descname">get_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#ProSnowObergurgl.get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.ProSnowObergurgl.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Image size of the ProSnow Obergurgl dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>size</strong> – The image size (height, width).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>tuple</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.dataset.SparcsDataset">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">SparcsDataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">use_bands</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gt_pattern</span><span class="o">=</span><span class="default_value">'(.*)gt\\.tif'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transforms</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#SparcsDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.SparcsDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.dataset.StandardEoDataset" title="core.dataset.StandardEoDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.dataset.StandardEoDataset</span></code></a></p>
<p>Class for the <a class="reference external" href="https://www.usgs.gov/land-resources/nli/landsat/spatial-procedures-automated-removal-cloud-and-shadow-sparcs-validation">Sparcs</a> dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_dir</strong> (<cite>str</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of the spectral bands to use. The default is [].</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite> or <cite>None</cite>, optional) – The size of the tiles. If not <cite>None</cite>, each scene is divided into square
tiles of shape (tile_size, tile_size). The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>, optional) – A regural expression to match the ground truth naming convention. All
directories and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for files
matching <code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>. The default is ‘(.*)gt\.tif’.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_samples</span></code>(scene)</p></td>
<td><p>Stack the bands of a sample in a single array.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">compose_scenes</span></code>()</p></td>
<td><p>Build the list of samples of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.SparcsDataset.get_labels" title="core.dataset.SparcsDataset.get_labels"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code></a>()</p></td>
<td><p>Class labels of the Sparcs dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.SparcsDataset.get_sensor" title="core.dataset.SparcsDataset.get_sensor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sensor</span></code></a>()</p></td>
<td><p>Landsat 8 bands of the Sparcs dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.SparcsDataset.get_size" title="core.dataset.SparcsDataset.get_size"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code></a>()</p></td>
<td><p>Image size of the Sparcs dataset.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.SparcsDataset.parse_scene_id" title="core.dataset.SparcsDataset.parse_scene_id"><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_scene_id</span></code></a>(scene_id)</p></td>
<td><p>Parse Sparcs scene identifiers (Landsat 8).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.dataset.SparcsDataset.preprocess" title="core.dataset.SparcsDataset.preprocess"><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code></a>(data, gt)</p></td>
<td><p>Preprocess Sparcs dataset images.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_scene</span></code>(idx)</p></td>
<td><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tensor</span></code>(x, dtype)</p></td>
<td><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.dataset.SparcsDataset.get_labels">
<code class="sig-name descname">get_labels</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#SparcsDataset.get_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.SparcsDataset.get_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Class labels of the Sparcs dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>labels</strong> – The class labels.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.SparcsDataset.get_sensor">
<code class="sig-name descname">get_sensor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#SparcsDataset.get_sensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.SparcsDataset.get_sensor" title="Permalink to this definition">¶</a></dt>
<dd><p>Landsat 8 bands of the Sparcs dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>sensor</strong> – An enumeration of the bands of the sensor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>enum.Enum</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.SparcsDataset.get_size">
<code class="sig-name descname">get_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#SparcsDataset.get_size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.SparcsDataset.get_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Image size of the Sparcs dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>size</strong> – The image size (height, width).</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>tuple</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.SparcsDataset.parse_scene_id">
<code class="sig-name descname">parse_scene_id</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#SparcsDataset.parse_scene_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.SparcsDataset.parse_scene_id" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse Sparcs scene identifiers (Landsat 8).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene_id</strong> (<cite>str</cite>) – A scene identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scene</strong> – A dictionary containing scene metadata. If <cite>None</cite>, <code class="docutils literal notranslate"><span class="pre">scene_id</span></code> is
not a valid Landsat scene identifier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite> or <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.dataset.SparcsDataset.preprocess">
<code class="sig-name descname">preprocess</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span></em>, <em class="sig-param"><span class="n">gt</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#SparcsDataset.preprocess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.SparcsDataset.preprocess" title="Permalink to this definition">¶</a></dt>
<dd><p>Preprocess Sparcs dataset images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The sample input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The sample ground truth.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>data</strong> (<cite>numpy.ndarray</cite>) – The preprocessed input data.</p></li>
<li><p><strong>gt</strong> (<cite>numpy.ndarray</cite>) – The preprocessed ground truth data.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.dataset.StandardEoDataset">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">StandardEoDataset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em>, <em class="sig-param"><span class="n">use_bands</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">gt_pattern</span><span class="o">=</span><span class="default_value">'(.*)gt\\.tif'</span></em>, <em class="sig-param"><span class="n">sort</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">transforms</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#StandardEoDataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.StandardEoDataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.dataset.ImageDataset" title="core.dataset.ImageDataset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.dataset.ImageDataset</span></code></a></p>
<p>Base class for standard Earth Observation style datasets.</p>
<p><cite>pysegcnn.core.dataset.StandardEoDataset</cite> implements the
<cite>~pysegcnn.core.dataset.StandardEoDataset.compose_scenes</cite> method for
datasets with the following directory structure:</p>
<dl>
<dt>root_dir/</dt><dd><dl class="simple">
<dt>scene_id_1/</dt><dd><p>scene_id_1_B1.tif
scene_id_1_B2.tif
.
.
.
scene_id_1_BN.tif</p>
</dd>
<dt>scene_id_2/</dt><dd><p>scene_id_2_B1.tif
scene_id_2_B2.tif
.
.
.
scene_id_2_BN.tif</p>
</dd>
</dl>
<p>.
scene_id_N/</p>
<blockquote>
<div><p>.</p>
</div></blockquote>
</dd>
</dl>
<p>If your dataset shares this directory structure, you can directly inherit
<cite>pysegcnn.core.dataset.StandardEoDataset</cite> and implement the remaining
methods.</p>
<p>See <cite>pysegcnn.core.dataset.SparcsDataset</cite> for an example.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_dir</strong> (<cite>str</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of the spectral bands to use. The default is [].</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite> or <cite>None</cite>, optional) – The size of the tiles. If not <cite>None</cite>, each scene is divided into square
tiles of shape (tile_size, tile_size). The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>, optional) – A regural expression to match the ground truth naming convention. All
directories and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for files
matching <code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>. The default is ‘(.*)gt\.tif’.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_samples</span></code>(scene)</p></td>
<td><p>Stack the bands of a sample in a single array.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.dataset.StandardEoDataset.compose_scenes" title="core.dataset.StandardEoDataset.compose_scenes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">compose_scenes</span></code></a>()</p></td>
<td><p>Build the list of samples of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_labels</span></code>()</p></td>
<td><p>Return an enumeration of the class labels of the dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sensor</span></code>()</p></td>
<td><p>Return an enumeration of the bands of the sensor of the dataset.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_size</span></code>()</p></td>
<td><p>Return the size of the images in the dataset.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parse_scene_id</span></code>(scene_id)</p></td>
<td><p>Parse the scene identifier.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">preprocess</span></code>(data, gt)</p></td>
<td><p>Preprocess a sample before feeding it to a model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">read_scene</span></code>(idx)</p></td>
<td><p>Read the data of the sample with index <code class="docutils literal notranslate"><span class="pre">idx</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_tensor</span></code>(x, dtype)</p></td>
<td><p>Convert <code class="docutils literal notranslate"><span class="pre">x</span></code> to <cite>torch.Tensor</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.dataset.StandardEoDataset.compose_scenes">
<code class="sig-name descname">compose_scenes</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#StandardEoDataset.compose_scenes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.StandardEoDataset.compose_scenes" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the list of samples of the dataset.</p>
<p>Each sample is represented by a dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>scenes</strong> –</p>
<dl class="simple">
<dt>Each item in <code class="docutils literal notranslate"><span class="pre">scenes</span></code> is a <cite>dict</cite> with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_1'</span></code></dt><dd><p>Path to the file of band_1.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_2'</span></code></dt><dd><p>Path to the file of band_2.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'band_name_n'</span></code></dt><dd><p>Path to the file of band_n.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'gt'</span></code></dt><dd><p>Path to the ground truth file.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'date'</span></code></dt><dd><p>The date of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tile'</span></code></dt><dd><p>The tile id of the sample.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'transform'</span></code></dt><dd><p>The transformation to apply.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'id'</span></code></dt><dd><p>The scene identifier.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>list</cite> [<cite>dict</cite>]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.dataset.SupportedDatasets">
<em class="property">class </em><code class="sig-prename descclassname">core.dataset.</code><code class="sig-name descname">SupportedDatasets</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/dataset.html#SupportedDatasets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.dataset.SupportedDatasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Names and corresponding classes of the implemented datasets.</p>
<dl class="py attribute">
<dt id="core.dataset.SupportedDatasets.Cloud95">
<code class="sig-name descname">Cloud95</code><em class="property"> = &lt;class 'core.dataset.Cloud95Dataset'&gt;</em><a class="headerlink" href="#core.dataset.SupportedDatasets.Cloud95" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.dataset.SupportedDatasets.Garmisch">
<code class="sig-name descname">Garmisch</code><em class="property"> = &lt;class 'core.dataset.ProSnowGarmisch'&gt;</em><a class="headerlink" href="#core.dataset.SupportedDatasets.Garmisch" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.dataset.SupportedDatasets.Obergurgl">
<code class="sig-name descname">Obergurgl</code><em class="property"> = &lt;class 'core.dataset.ProSnowObergurgl'&gt;</em><a class="headerlink" href="#core.dataset.SupportedDatasets.Obergurgl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.dataset.SupportedDatasets.Sparcs">
<code class="sig-name descname">Sparcs</code><em class="property"> = &lt;class 'core.dataset.SparcsDataset'&gt;</em><a class="headerlink" href="#core.dataset.SupportedDatasets.Sparcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-core.graphics">
<span id="core-graphics-module"></span><h2>core.graphics module<a class="headerlink" href="#module-core.graphics" title="Permalink to this headline">¶</a></h2>
<p>Functions to plot multispectral image data and model output.</p>
<div class="section" id="id4">
<h3>License<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py function">
<dt id="core.graphics.contrast_stretching">
<code class="sig-prename descclassname">core.graphics.</code><code class="sig-name descname">contrast_stretching</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/graphics.html#contrast_stretching"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.graphics.contrast_stretching" title="Permalink to this definition">¶</a></dt>
<dd><p>Apply percentile stretching to an image to increase constrast.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<cite>numpy.ndarray</cite>) – the input image.</p></li>
<li><p><strong>alpha</strong> (<cite>int</cite>, optional) – The level of the percentiles. The default is 5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>norm</strong> – the stretched image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.graphics.plot_confusion_matrix">
<code class="sig-prename descclassname">core.graphics.</code><code class="sig-name descname">plot_confusion_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cm</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">normalize</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 10</span></em>, <em class="sig-param"><span class="n">cmap</span><span class="o">=</span><span class="default_value">'Blues'</span></em>, <em class="sig-param"><span class="n">state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outpath</span><span class="o">=</span><span class="default_value">'c:\\eurac\\2020\\git\\pysegcnn\\pysegcnn\\main\\_graphics/'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/graphics.html#plot_confusion_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.graphics.plot_confusion_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the confusion matrix <code class="docutils literal notranslate"><span class="pre">cm</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cm</strong> (<cite>numpy.ndarray</cite>) – The confusion matrix.</p></li>
<li><p><strong>labels</strong> (<cite>dict</cite> [<cite>int</cite>, <cite>dict</cite>]) – <p>The label dictionary. The keys are the values of the class labels
in the ground truth <code class="docutils literal notranslate"><span class="pre">y</span></code>. Each nested <cite>dict</cite> should have keys:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'color'</span></code></dt><dd><p>A named color (<cite>str</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'label'</span></code></dt><dd><p>The name of the class label (<cite>str</cite>).</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>normalize</strong> (<cite>bool</cite>, optional) – Whether to normalize the confusion matrix. The default is True.</p></li>
<li><p><strong>figsize</strong> (<cite>tuple</cite>, optional) – The figure size in centimeters. The default is (10, 10).</p></li>
<li><p><strong>cmap</strong> (<cite>str</cite>, optional) – A colormap in <cite>matplotlib.pyplot.colormaps()</cite>. The default is ‘Blues’.</p></li>
<li><p><strong>state</strong> (<cite>str</cite> or <cite>None</cite>, optional) – Filename to save the plot to. <code class="docutils literal notranslate"><span class="pre">state</span></code> should be an existing model
state file ending with ‘.pt’. The default is None, i.e. plot is not
saved to disk.</p></li>
<li><p><strong>outpath</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>, optional) – Output path. The default is ‘pysegcnn/main/_graphics/’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<cite>matplotlib.figure.Figure</cite>) – The figure handle.</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.axes._subplots.AxesSubplot</cite>) – The axes handle.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.graphics.plot_loss">
<code class="sig-prename descclassname">core.graphics.</code><code class="sig-name descname">plot_loss</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_file</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 10</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">colors</span><span class="o">=</span><span class="default_value">['lightgreen', 'green', 'skyblue', 'steelblue']</span></em>, <em class="sig-param"><span class="n">outpath</span><span class="o">=</span><span class="default_value">'c:\\eurac\\2020\\git\\pysegcnn\\pysegcnn\\main\\_graphics/'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/graphics.html#plot_loss"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.graphics.plot_loss" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the observed loss and accuracy of a model run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_file</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – The model state file. Model state files are stored in
pysegcnn/main/_models.</p></li>
<li><p><strong>figsize</strong> (<cite>tuple</cite>, optional) – The figure size in centimeters. The default is (10, 10).</p></li>
<li><p><strong>step</strong> (<cite>int</cite>, optional) – The step of epochs for the x-axis labels. The default is 5, i.e. label
each fifth epoch.</p></li>
<li><p><strong>colors</strong> (<cite>list</cite> [<cite>str</cite>], optional) – A list of four named colors supported by <cite>matplotlib</cite>.
The default is [‘lightgreen’, ‘green’, ‘skyblue’, ‘steelblue’].</p></li>
<li><p><strong>outpath</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>, optional) – Output path. The default is ‘pysegcnn/main/_graphics/’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fig</strong> – The figure handle.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>matplotlib.figure.Figure</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.graphics.plot_sample">
<code class="sig-prename descclassname">core.graphics.</code><code class="sig-name descname">plot_sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">use_bands</span></em>, <em class="sig-param"><span class="n">labels</span></em>, <em class="sig-param"><span class="n">y</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">y_pred</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">figsize</span><span class="o">=</span><span class="default_value">10, 10</span></em>, <em class="sig-param"><span class="n">bands</span><span class="o">=</span><span class="default_value">['nir', 'red', 'green']</span></em>, <em class="sig-param"><span class="n">state</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">outpath</span><span class="o">=</span><span class="default_value">'c:\\eurac\\2020\\git\\pysegcnn\\pysegcnn\\main\\_samples/'</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/graphics.html#plot_sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.graphics.plot_sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot false color composite (FCC), ground truth and model prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>numpy.ndarray</cite> or <cite>torch.Tensor</cite>, (b, h, w)) – Array containing the raw data of the tile, shape=(bands, height, width)</p></li>
<li><p><strong>use_bands</strong> (<cite>list</cite> of <cite>str</cite>) – List describing the order of the bands in <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p></li>
<li><p><strong>labels</strong> (<cite>dict</cite> [<cite>int</cite>, <cite>dict</cite>]) – <p>The label dictionary. The keys are the values of the class labels
in the ground truth <code class="docutils literal notranslate"><span class="pre">y</span></code>. Each nested <cite>dict</cite> should have keys:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'color'</span></code></dt><dd><p>A named color (<cite>str</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'label'</span></code></dt><dd><p>The name of the class label (<cite>str</cite>).</p>
</dd>
</dl>
</div></blockquote>
</p></li>
<li><p><strong>y</strong> (<cite>numpy.ndarray</cite> or <cite>torch.Tensor</cite> or <cite>None</cite>, optional) – Array containing the ground truth of tile <code class="docutils literal notranslate"><span class="pre">x</span></code>, shape=(height, width).
The default is None.</p></li>
<li><p><strong>y_pred</strong> (<cite>numpy.ndarray</cite> or <cite>torch.Tensor</cite> or <cite>None</cite>, optional) – Array containing the prediction for tile <code class="docutils literal notranslate"><span class="pre">x</span></code>, shape=(height, width).
The default is None.</p></li>
<li><p><strong>figsize</strong> (<cite>tuple</cite>, optional) – The figure size in centimeters. The default is (10, 10).</p></li>
<li><p><strong>bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – The bands to build the FCC. The default is [‘nir’, ‘red’, ‘green’].</p></li>
<li><p><strong>state</strong> (<cite>str</cite> or <cite>None</cite>, optional) – Filename to save the plot to. <code class="docutils literal notranslate"><span class="pre">state</span></code> should be an existing model
state file ending with ‘.pt’. The default is None, i.e. plot is not
saved to disk.</p></li>
<li><p><strong>outpath</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>, optional) – Output path. The default is ‘pysegcnn/main/_samples’.</p></li>
<li><p><strong>alpha</strong> (<cite>int</cite>, optional) – The level of the percentiles to increase constrast in the FCC.
The default is 0, i.e. no stretching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>fig</strong> (<cite>matplotlib.figure.Figure</cite>) – The figure handle.</p></li>
<li><p><strong>ax</strong> (<cite>numpy.ndarray</cite> [<cite>matplotlib.axes._subplots.AxesSubplot</cite>]) – An array of the axes handles.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.graphics.running_mean">
<code class="sig-prename descclassname">core.graphics.</code><code class="sig-name descname">running_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">w</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/graphics.html#running_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.graphics.running_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute a running mean of the input sequence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array_like</em>) – The sequence to compute a running mean on.</p></li>
<li><p><strong>w</strong> (<cite>int</cite>) – The window length of the running mean.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>rm</strong> – The running mean of the sequence <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-core.layers">
<span id="core-layers-module"></span><h2>core.layers module<a class="headerlink" href="#module-core.layers" title="Permalink to this headline">¶</a></h2>
<p>Layers of a convolutional encoder-decoder network.</p>
<div class="section" id="id5">
<h3>License<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py class">
<dt id="core.layers.Block">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">Block</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Block"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Block" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Basic convolutional block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<cite>int</cite>) – Number of output channels.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional arguments passed to <cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – Raised if <cite>~pysegcnn.core.layers.Block.layers</cite> method does not return
an instance of <cite>torch.nn.Sequential</cite>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.Block.forward" title="core.layers.Block.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>()</p></td>
<td><p>Forward pass of the block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.Block.layers" title="core.layers.Block.layers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">layers</span></code></a>()</p></td>
<td><p>Define the layers of the block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.Block.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Block.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Block.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass of the block.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if <cite>pysegcnn.core.layers.Block</cite> is not inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.layers.Block.layers">
<code class="sig-name descname">layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Block.layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Block.layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the layers of the block.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if <cite>pysegcnn.core.layers.Block</cite> is not inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>layers</strong> – Return an instance of <cite>torch.nn.Sequential</cite> containing a sequence
of layer (<cite>torch.nn.Module</cite> ) instances.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.nn.Sequential</cite> [<cite>torch.nn.Module</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.Block.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.Block.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.Conv2dSame">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">Conv2dSame</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Conv2dSame"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Conv2dSame" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.conv.Conv2d</span></code></p>
<p>A convolution preserving the shape of its input.</p>
<p>Given the kernel size, the dilation and a stride of 1, the padding is
calculated such that the output of the convolution has the same spatial
dimensions as the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<cite>list</cite> [<cite>str</cite>]) – <dl class="simple">
<dt>positional arguments passed to <cite>torch.nn.Conv2d</cite>:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'in_channels'</span></code>: <cite>int</cite></dt><dd><p>Number of input channels.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'out_channels'</span></code>: <cite>int</cite></dt><dd><p>Number of output channels.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'kernel_size'</span></code>: <cite>int</cite> or <cite>tuple</cite> [<cite>int</cite>]</dt><dd><p>Size of the convolving kernel.</p>
</dd>
</dl>
</dd>
</dl>
</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional keyword arguments passed to <a href="#id23"><span class="problematic" id="id24">`torch.nn.Conv2d`_</span></a>.</p></li>
<li><p><strong>_torch.nn.Conv2d</strong> (<em>.</em>) – <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html#torch.nn.Conv2d">https://pytorch.org/docs/stable/generated/torch.nn.Conv2d.html#torch.nn.Conv2d</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.Conv2dSame.same_padding" title="core.layers.Conv2dSame.same_padding"><code class="xref py py-obj docutils literal notranslate"><span class="pre">same_padding</span></code></a>(d, k)</p></td>
<td><p>Calculate the amount of padding.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 67%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>forward</strong></p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><strong>reset_parameters</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="core.layers.Conv2dSame.bias">
<code class="sig-name descname">bias</code><em class="property">: Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></em><a class="headerlink" href="#core.layers.Conv2dSame.bias" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.dilation">
<code class="sig-name descname">dilation</code><em class="property">: Tuple<span class="p">[</span>int<span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#core.layers.Conv2dSame.dilation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.groups">
<code class="sig-name descname">groups</code><em class="property">: int</em><a class="headerlink" href="#core.layers.Conv2dSame.groups" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.kernel_size">
<code class="sig-name descname">kernel_size</code><em class="property">: Tuple<span class="p">[</span>int<span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#core.layers.Conv2dSame.kernel_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.out_channels">
<code class="sig-name descname">out_channels</code><em class="property">: int</em><a class="headerlink" href="#core.layers.Conv2dSame.out_channels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.output_padding">
<code class="sig-name descname">output_padding</code><em class="property">: Tuple<span class="p">[</span>int<span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#core.layers.Conv2dSame.output_padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.padding">
<code class="sig-name descname">padding</code><em class="property">: Tuple<span class="p">[</span>int<span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#core.layers.Conv2dSame.padding" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.padding_mode">
<code class="sig-name descname">padding_mode</code><em class="property">: str</em><a class="headerlink" href="#core.layers.Conv2dSame.padding_mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.layers.Conv2dSame.same_padding">
<em class="property">static </em><code class="sig-name descname">same_padding</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span></em>, <em class="sig-param"><span class="n">k</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Conv2dSame.same_padding"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Conv2dSame.same_padding" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the amount of padding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> (<cite>int</cite>) – The dilation of the convolution.</p></li>
<li><p><strong>k</strong> (<cite>int</cite>) – The kernel size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>p</strong> – the amount of padding.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.stride">
<code class="sig-name descname">stride</code><em class="property">: Tuple<span class="p">[</span>int<span class="p">, </span><span class="p">…</span><span class="p">]</span></em><a class="headerlink" href="#core.layers.Conv2dSame.stride" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.transposed">
<code class="sig-name descname">transposed</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.Conv2dSame.transposed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.layers.Conv2dSame.weight">
<code class="sig-name descname">weight</code><em class="property">: torch.Tensor</em><a class="headerlink" href="#core.layers.Conv2dSame.weight" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.ConvBnReluMaxPool">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">ConvBnReluMaxPool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxPool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxPool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.layers.EncoderBlock" title="core.layers.EncoderBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.layers.EncoderBlock</span></code></a></p>
<p>Block of convolution, batchnorm, relu and 2x2 max pool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<cite>int</cite>) – Number of output channels.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional keyword arguments passed to
<cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.layers.ConvBnReluMaxPool.downsample" title="core.layers.ConvBnReluMaxPool.downsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downsample</span></code></a>(x)</p></td>
<td><p>2x2 max pooling layer, <cite>torch.nn.functional.max_pool2d</cite>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.layers.ConvBnReluMaxPool.extra_repr" title="core.layers.ConvBnReluMaxPool.extra_repr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code></a>()</p></td>
<td><p>Define optional extra information about this module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code>(x)</p></td>
<td><p>Forward pass of an encoder block.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.layers.ConvBnReluMaxPool.layers" title="core.layers.ConvBnReluMaxPool.layers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">layers</span></code></a>()</p></td>
<td><p>Sequence of convolution, batchnorm and relu layers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.ConvBnReluMaxPool.downsample">
<code class="sig-name descname">downsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxPool.downsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxPool.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>2x2 max pooling layer, <cite>torch.nn.functional.max_pool2d</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Input tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height // 2, width // 2)) – The 2x2 max pooled tensor.</p></li>
<li><p><strong>indices</strong> (<cite>torch.Tensor</cite> or <cite>None</cite>) – The indices of the maxima. Useful for upsampling with
<cite>torch.nn.functional.max_unpool2d</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.layers.ConvBnReluMaxPool.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxPool.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxPool.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Define optional extra information about this module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Extra representation string.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.layers.ConvBnReluMaxPool.layers">
<code class="sig-name descname">layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxPool.layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxPool.layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence of convolution, batchnorm and relu layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>layers</strong> – An instance of <cite>torch.nn.Sequential</cite> containing the sequence
of convolution, batchnorm and relu layer (<cite>torch.nn.Module</cite>)
instances.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>torch.nn.Sequential</cite> [<cite>torch.nn.Module</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.ConvBnReluMaxPool.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.ConvBnReluMaxPool.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.ConvBnReluMaxUnpool">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">ConvBnReluMaxUnpool</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxUnpool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxUnpool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.layers.DecoderBlock" title="core.layers.DecoderBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.layers.DecoderBlock</span></code></a></p>
<p>Block of convolution, batchnorm, relu and 2x2 max unpool.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<cite>int</cite>) – Number of output channels</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional keyword arguments passed to
<cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.ConvBnReluMaxUnpool.extra_repr" title="core.layers.ConvBnReluMaxUnpool.extra_repr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code></a>()</p></td>
<td><p>Define optional extra information about this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code>(x, feature, indices, skip)</p></td>
<td><p>Forward pass of a decoder block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.ConvBnReluMaxUnpool.layers" title="core.layers.ConvBnReluMaxUnpool.layers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">layers</span></code></a>()</p></td>
<td><p>Sequence of convolution, batchnorm and relu layers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.ConvBnReluMaxUnpool.upsample" title="core.layers.ConvBnReluMaxUnpool.upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upsample</span></code></a>(x, feature, indices)</p></td>
<td><p>2x2 max unpooling layer.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.ConvBnReluMaxUnpool.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxUnpool.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxUnpool.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Define optional extra information about this module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Extra representation string.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.layers.ConvBnReluMaxUnpool.layers">
<code class="sig-name descname">layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxUnpool.layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxUnpool.layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence of convolution, batchnorm and relu layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>layers</strong> – An instance of <cite>torch.nn.Sequential</cite> containing the sequence
of convolution, batchnorm and relu layer (<cite>torch.nn.Module</cite>)
instances.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>torch.nn.Sequential</cite> [<cite>torch.nn.Module</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.ConvBnReluMaxUnpool.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.ConvBnReluMaxUnpool.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.layers.ConvBnReluMaxUnpool.upsample">
<code class="sig-name descname">upsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">feature</span></em>, <em class="sig-param"><span class="n">indices</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluMaxUnpool.upsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluMaxUnpool.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>2x2 max unpooling layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Input tensor.</p></li>
<li><p><strong>feature</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Intermediate output of a layer in the encoder. Used to determine
the output shape of the upsampling operation.</p></li>
<li><p><strong>indices</strong> (<cite>torch.Tensor</cite>) – The indices of the maxima of the max pooling operation
(as returned by <cite>torch.nn.functional.max_pool2d</cite>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – The 2x2 max unpooled tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite>, shape=(batch, channel, height * 2, width * 2)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.ConvBnReluUpsample">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">ConvBnReluUpsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluUpsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluUpsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.layers.DecoderBlock" title="core.layers.DecoderBlock"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.layers.DecoderBlock</span></code></a></p>
<p>Block of convolution, batchnorm, relu and nearest neighbor upsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<cite>int</cite>) – Number of output channels</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional arguments passed to <cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.ConvBnReluUpsample.extra_repr" title="core.layers.ConvBnReluUpsample.extra_repr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code></a>()</p></td>
<td><p>Define optional extra information about this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code>(x, feature, indices, skip)</p></td>
<td><p>Forward pass of a decoder block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.ConvBnReluUpsample.layers" title="core.layers.ConvBnReluUpsample.layers"><code class="xref py py-obj docutils literal notranslate"><span class="pre">layers</span></code></a>()</p></td>
<td><p>Sequence of convolution, batchnorm and relu layers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.ConvBnReluUpsample.upsample" title="core.layers.ConvBnReluUpsample.upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upsample</span></code></a>(x, feature[, indices])</p></td>
<td><p>Nearest neighbor upsampling.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.ConvBnReluUpsample.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluUpsample.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluUpsample.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Define optional extra information about this module.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Extra representation string.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.layers.ConvBnReluUpsample.layers">
<code class="sig-name descname">layers</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluUpsample.layers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluUpsample.layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Sequence of convolution, batchnorm and relu layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>layers</strong> – An instance of <cite>torch.nn.Sequential</cite> containing the sequence
of convolution, batchnorm and relu layer (<cite>torch.nn.Module</cite>)
instances.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>torch.nn.Sequential</cite> [<cite>torch.nn.Module</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.ConvBnReluUpsample.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.ConvBnReluUpsample.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.layers.ConvBnReluUpsample.upsample">
<code class="sig-name descname">upsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">feature</span></em>, <em class="sig-param"><span class="n">indices</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#ConvBnReluUpsample.upsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.ConvBnReluUpsample.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Nearest neighbor upsampling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Input tensor.</p></li>
<li><p><strong>feature</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Intermediate output of a layer in the encoder. Used to determine
the output shape of the upsampling operation.</p></li>
<li><p><strong>indices</strong> (<cite>None</cite>, optional) – The indices of the maxima of the max pooling operation
(as returned by <cite>torch.nn.functional.max_pool2d</cite>). Not required by
this upsampling method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – The 2x2 upsampled tensor.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite>, shape=(batch, channel, height, width)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.Decoder">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">Decoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="n">skip</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Decoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Decoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Generic convolutional decoder.</p>
<p>When instanciating an encoder-decoder architechure, <code class="docutils literal notranslate"><span class="pre">filters</span></code> should be
the same for <cite>pysegcnn.core.layers.Encoder</cite> and
<cite>pysegcnn.core.layers.Decoder</cite>.</p>
<p>See <cite>pysegcnn.core.models.UNet</cite> for an example implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filters</strong> (<cite>list</cite> [<cite>int</cite>]) – List of input channels to each convolutional block. The length of
<code class="docutils literal notranslate"><span class="pre">filters</span></code> determines the depth of the decoder. The first element of
<code class="docutils literal notranslate"><span class="pre">filters</span></code> has to be the number of channels of the input images.</p></li>
<li><p><strong>block</strong> (<cite>pysegcnn.core.layers.DecoderBlock</cite>) – The convolutional block defining a layer in the decoder.
A subclass of <cite>pysegcnn.core.layers.DecoderBlock</cite>, e.g.
<cite>pysegcnn.core.layers.ConvBnReluMaxUnpool</cite>.</p></li>
<li><p><strong>skip</strong> (<cite>bool</cite>) – Whether to apply skip connections from the encoder to the decoder.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional arguments passed to <cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.Decoder.forward" title="core.layers.Decoder.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x, enc_cache)</p></td>
<td><p>Forward pass of the decoder.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.Decoder.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">enc_cache</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Decoder.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Decoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass of the decoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Output of the encoder.</p></li>
<li><p><strong>enc_cache</strong> (<cite>dict</cite> [<cite>dict</cite>]) – <p>Cache dictionary. The keys of the dictionary are the number of the
network layers and the values are dictionaries with the following
(key, value) pairs:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;feature&quot;</span></code></dt><dd><p>The intermediate encoder outputs (<cite>torch.Tensor</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;indices&quot;</span></code></dt><dd><p>The indices of the max pooling layer (<cite>torch.Tensor</cite>).</p>
</dd>
</dl>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – Output of the decoder.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite>, shape=(batch, channel, height, width)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.Decoder.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.Decoder.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.DecoderBlock">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">DecoderBlock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#DecoderBlock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.DecoderBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.layers.Block" title="core.layers.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.layers.Block</span></code></a></p>
<p>Block of a convolutional decoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<cite>int</cite>) – Number of output channels.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional arguments passed to <cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.DecoderBlock.forward" title="core.layers.DecoderBlock.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x, feature, indices, skip)</p></td>
<td><p>Forward pass of a decoder block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">layers</span></code>()</p></td>
<td><p>Define the layers of the block.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.DecoderBlock.upsample" title="core.layers.DecoderBlock.upsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">upsample</span></code></a>(x, feature, indices)</p></td>
<td><p>Define the upsampling method.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.DecoderBlock.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">feature</span></em>, <em class="sig-param"><span class="n">indices</span></em>, <em class="sig-param"><span class="n">skip</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#DecoderBlock.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.DecoderBlock.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass of a decoder block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Input tensor.</p></li>
<li><p><strong>feature</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Intermediate output of a layer in the encoder.
If <code class="docutils literal notranslate"><span class="pre">skip</span></code> = True, <code class="docutils literal notranslate"><span class="pre">feature</span></code> is concatenated (along the channel
axis) to the output of the respective upsampling layer in the
decoder (skip connection).</p></li>
<li><p><strong>indices</strong> (<cite>torch.Tensor</cite> or <cite>None</cite>) – Indices of the encoder downsampling method.</p></li>
<li><p><strong>skip</strong> (<cite>bool</cite>) – Whether to apply the skip connection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – Output of the decoder block.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite>, shape=(batch, channel, height, width)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.DecoderBlock.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.DecoderBlock.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.layers.DecoderBlock.upsample">
<code class="sig-name descname">upsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em>, <em class="sig-param"><span class="n">feature</span></em>, <em class="sig-param"><span class="n">indices</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#DecoderBlock.upsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.DecoderBlock.upsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the upsampling method.</p>
<p>The <cite>~pysegcnn.core.layers.DecoderBlock.upsample</cite> method should
implement the spatial upsampling operation.</p>
<dl class="simple">
<dt>Use one of the following functions to upsample:</dt><dd><ul class="simple">
<li><p><cite>torch.nn.functional.max_unpool2d</cite></p></li>
<li><p><cite>torch.nn.functional.interpolate</cite></p></li>
</ul>
</dd>
</dl>
<p>See <cite>pysegcnn.core.layers.ConvBnReluMaxUnpool</cite> or
<cite>pysegcnn.core.layers.ConvBnReluUpsample</cite> for an example
implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Input tensor, e.g. output of a convolutional block.</p></li>
<li><p><strong>feature</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Intermediate output of a layer in the encoder. Used to implement
skip connections.</p></li>
<li><p><strong>indices</strong> (<cite>torch.Tensor</cite> or <cite>None</cite>) – Indices of the encoder downsampling method.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Raised if <cite>pysegcnn.core.layers.DecoderBlock</cite> is not inherited.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>x</strong> – The spatially upsampled tensor.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>torch.Tensor</cite>, shape=(batch, channel, height, width)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.Encoder">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">Encoder</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">block</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Encoder"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Encoder" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Generic convolutional encoder.</p>
<p>When instanciating an encoder-decoder architechure, <code class="docutils literal notranslate"><span class="pre">filters</span></code> should be
the same for <cite>pysegcnn.core.layers.Encoder</cite> and
<cite>pysegcnn.core.layers.Decoder</cite>.</p>
<p>See <cite>pysegcnn.core.models.UNet</cite> for an example implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filters</strong> (<cite>list</cite> [<cite>int</cite>]) – List of input channels to each convolutional block. The length of
<code class="docutils literal notranslate"><span class="pre">filters</span></code> determines the depth of the encoder. The first element of
<code class="docutils literal notranslate"><span class="pre">filters</span></code> has to be the number of channels of the input images.</p></li>
<li><p><strong>block</strong> (<cite>pysegcnn.core.layers.EncoderBlock</cite>) – The convolutional block defining a layer in the encoder.
A subclass of <cite>pysegcnn.core.layers.EncoderBlock</cite>, e.g.
<cite>pysegcnn.core.layers.ConvBnReluMaxPool</cite>.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional arguments passed to <cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.layers.Encoder.forward" title="core.layers.Encoder.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x)</p></td>
<td><p>Forward pass of the encoder.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.Encoder.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#Encoder.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.Encoder.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass of the encoder.</p>
<p>Stores intermediate outputs in a dictionary. The keys of the dictionary
are the number of the network layers and the values are dictionaries
with the following (key, value) pairs:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">&quot;feature&quot;</span></code></dt><dd><p>The intermediate encoder outputs (<cite>torch.Tensor</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">&quot;indices&quot;</span></code></dt><dd><p>The indices of the max pooling layer, if required
(<cite>torch.Tensor</cite>).</p>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Input image.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>x</strong> – Output of the encoder.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.Tensor</cite>, shape=(batch, channel, height, width)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.Encoder.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.Encoder.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.layers.EncoderBlock">
<em class="property">class </em><code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">EncoderBlock</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#EncoderBlock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.EncoderBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.layers.Block" title="core.layers.Block"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.layers.Block</span></code></a></p>
<p>Block of a convolutional encoder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<cite>int</cite>) – Number of output channels.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional arguments passed to <cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.layers.EncoderBlock.downsample" title="core.layers.EncoderBlock.downsample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">downsample</span></code></a>(x)</p></td>
<td><p>Define the downsampling method.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.layers.EncoderBlock.forward" title="core.layers.EncoderBlock.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x)</p></td>
<td><p>Forward pass of an encoder block.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">layers</span></code>()</p></td>
<td><p>Define the layers of the block.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.layers.EncoderBlock.downsample">
<code class="sig-name descname">downsample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#EncoderBlock.downsample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.EncoderBlock.downsample" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the downsampling method.</p>
<p>The <cite>~pysegcnn.core.layers.EncoderBlock.downsample</cite> method should
implement the spatial pooling operation.</p>
<dl class="simple">
<dt>Use one of the following functions to downsample:</dt><dd><ul class="simple">
<li><p><cite>torch.nn.functional.max_pool2d</cite></p></li>
<li><p><cite>torch.nn.functional.interpolate</cite></p></li>
</ul>
</dd>
</dl>
<p>See <cite>pysegcnn.core.layers.ConvBnReluMaxPool</cite> for an example
implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Input tensor, e.g. output of a convolutional block.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – Raised if <cite>pysegcnn.core.layers.EncoderBlock</cite> is not inherited.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – The spatially downsampled tensor.</p></li>
<li><p><strong>indices</strong> (<cite>torch.Tensor</cite> or <cite>None</cite>) – Optional indices of the downsampling method, e.g. indices of the
maxima when using <cite>torch.nn.functional.max_pool2d</cite>. Useful for
upsampling later. If no indices are required to upsample, simply
return <code class="docutils literal notranslate"><span class="pre">indices</span></code> = <cite>None</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.layers.EncoderBlock.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#EncoderBlock.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.EncoderBlock.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward pass of an encoder block.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<cite>torch.Tensor</cite>) – Input tensor, e.g. output of the previous block/layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>y</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Output of the encoder block.</p></li>
<li><p><strong>x</strong> (<cite>torch.Tensor</cite>, shape=(batch, channel, height, width)) – Intermediate output before applying downsampling. Useful to
implement skip connections.</p></li>
<li><p><strong>indices</strong> (<cite>torch.Tensor</cite> or <cite>None</cite>) – Optional indices of the downsampling method, e.g. indices of the
maxima when using <cite>torch.nn.functional.max_pool2d</cite>. Useful for
upsampling later. If no indices are required to upsample, simply
return <code class="docutils literal notranslate"><span class="pre">indices</span></code> = <cite>None</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.layers.EncoderBlock.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.layers.EncoderBlock.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="core.layers.conv_bn_relu">
<code class="sig-prename descclassname">core.layers.</code><code class="sig-name descname">conv_bn_relu</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/layers.html#conv_bn_relu"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.layers.conv_bn_relu" title="Permalink to this definition">¶</a></dt>
<dd><p>Block of convolution, batch normalization and rectified linear unit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of input channels.</p></li>
<li><p><strong>out_channels</strong> (<cite>int</cite>) – Number of output channels.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional arguments passed to <cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>block</strong> – An instance of <cite>torch.nn.Sequential</cite> containing a sequence of
convolution, batch normalization and rectified linear unit layers.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.nn.Sequential</cite> [<cite>torch.nn.Module</cite>]</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-core.logging">
<span id="core-logging-module"></span><h2>core.logging module<a class="headerlink" href="#module-core.logging" title="Permalink to this headline">¶</a></h2>
<p>Logging configuration.</p>
<div class="section" id="id6">
<h3>License<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py function">
<dt id="core.logging.log_conf">
<code class="sig-prename descclassname">core.logging.</code><code class="sig-name descname">log_conf</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">logfile</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/logging.html#log_conf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.logging.log_conf" title="Permalink to this definition">¶</a></dt>
<dd><p>Set basic logging configuration passed to <cite>logging.config.dictConfig</cite>.</p>
<p>See the logging <a class="reference external" href="https://docs.python.org/3/library/logging.config.html#dictionary-schema-details">docs</a> for a detailed description of the configuration
dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>logfile</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – The file to save the logs to.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>LOGGING_CONFIG</strong> – The logging configuration.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-core.models">
<span id="core-models-module"></span><h2>core.models module<a class="headerlink" href="#module-core.models" title="Permalink to this headline">¶</a></h2>
<p>Neural networks for semantic image segmentation.</p>
<div class="section" id="id7">
<h3>License<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py class">
<dt id="core.models.Network">
<em class="property">class </em><code class="sig-prename descclassname">core.models.</code><code class="sig-name descname">Network</code><a class="reference internal" href="../_modules/core/models.html#Network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.Network" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Generic Network class.</p>
<p>The base class for each model. If you want to implement a new model,
inherit the <code class="docutils literal notranslate"><span class="pre">~pysegcnn.core.models.Network</span></code> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
<dt class="field-odd">Attributes</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="#core.models.Network.state" title="core.models.Network.state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">state</span></code></a></dt><dd><p>Return the model state file.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code>(*input)</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.models.Network.freeze" title="core.models.Network.freeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze</span></code></a>()</p></td>
<td><p>Freeze the weights of a model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.models.Network.load" title="core.models.Network.load"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code></a>(state_file)</p></td>
<td><p>Load a model state.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.models.Network.save" title="core.models.Network.save"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code></a>(state_file, optimizer[, bands])</p></td>
<td><p>Save the model state.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.models.Network.unfreeze" title="core.models.Network.unfreeze"><code class="xref py py-obj docutils literal notranslate"><span class="pre">unfreeze</span></code></a>()</p></td>
<td><p>Unfreeze the weights of a model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.models.Network.freeze">
<code class="sig-name descname">freeze</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#Network.freeze"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.Network.freeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Freeze the weights of a model.</p>
<p>Disables gradient computation: useful when using a pretrained model for
inference.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.models.Network.load">
<em class="property">static </em><code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#Network.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.Network.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a model state.</p>
<p>Returns the model in <code class="docutils literal notranslate"><span class="pre">state_file</span></code> with the pretrained model and
optimizer weights. Useful when resuming training an existing model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_file</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – The model state file. Model state files are stored in
pysegcnn/main/_models.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">state_file</span></code> does not exist.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>model</strong> (<cite>pysegcnn.core.models.Network</cite>) – The pretrained model.</p></li>
<li><p><strong>optimizer</strong> (<cite>torch.optim.Optimizer</cite>) – The optimizer used to train the model.</p></li>
<li><p><strong>model_state</strong> (‘<cite>dict</cite>) – A dictionary containing the model and optimizer state, as
constructed by <cite>~pysegcnn.core.Network.save</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.models.Network.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_file</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">bands</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#Network.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.Network.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model state.</p>
<p>Saves the model and optimizer states together with the model
construction parameters, to easily re-instanciate the model.</p>
<p>Optional <code class="docutils literal notranslate"><span class="pre">kwargs</span></code> are also saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_file</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – Path to save the model state.</p></li>
<li><p><strong>optimizer</strong> (<cite>torch.optim.Optimizer</cite>) – The optimizer used to train the model.</p></li>
<li><p><strong>bands</strong> (<cite>list</cite> [<cite>str</cite>] or <cite>None</cite>, optional) – List of bands the model is trained with. The default is None.</p></li>
<li><p><strong>**kwargs</strong> – Arbitrary keyword arguments. Each keyword argument will be saved
as (key, value) pair in <code class="docutils literal notranslate"><span class="pre">state_file</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>model_state</strong> – A dictionary containing the model and optimizer state</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.models.Network.state">
<em class="property">property </em><code class="sig-name descname">state</code><a class="headerlink" href="#core.models.Network.state" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the model state file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>state_file</strong> – The model state file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pathlib.Path</cite> or <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.models.Network.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.models.Network.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.models.Network.unfreeze">
<code class="sig-name descname">unfreeze</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#Network.unfreeze"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.Network.unfreeze" title="Permalink to this definition">¶</a></dt>
<dd><p>Unfreeze the weights of a model.</p>
<p>Enables gradient computation: useful when adjusting a pretrained model
to a new dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.models.SupportedLossFunctions">
<em class="property">class </em><code class="sig-prename descclassname">core.models.</code><code class="sig-name descname">SupportedLossFunctions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#SupportedLossFunctions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.SupportedLossFunctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Names and corresponding classes of the tested loss functions.</p>
<dl class="py attribute">
<dt id="core.models.SupportedLossFunctions.CrossEntropy">
<code class="sig-name descname">CrossEntropy</code><em class="property"> = &lt;class 'torch.nn.modules.loss.CrossEntropyLoss'&gt;</em><a class="headerlink" href="#core.models.SupportedLossFunctions.CrossEntropy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.models.SupportedModels">
<em class="property">class </em><code class="sig-prename descclassname">core.models.</code><code class="sig-name descname">SupportedModels</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#SupportedModels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.SupportedModels" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Names and corresponding classes of the implemented models.</p>
<dl class="py attribute">
<dt id="core.models.SupportedModels.Unet">
<code class="sig-name descname">Unet</code><em class="property"> = &lt;class 'core.models.UNet'&gt;</em><a class="headerlink" href="#core.models.SupportedModels.Unet" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.models.SupportedOptimizers">
<em class="property">class </em><code class="sig-prename descclassname">core.models.</code><code class="sig-name descname">SupportedOptimizers</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#SupportedOptimizers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.SupportedOptimizers" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Names and corresponding classes of the tested optimizers.</p>
<dl class="py attribute">
<dt id="core.models.SupportedOptimizers.Adam">
<code class="sig-name descname">Adam</code><em class="property"> = &lt;class 'torch.optim.adam.Adam'&gt;</em><a class="headerlink" href="#core.models.SupportedOptimizers.Adam" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.models.UNet">
<em class="property">class </em><code class="sig-prename descclassname">core.models.</code><code class="sig-name descname">UNet</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">nclasses</span></em>, <em class="sig-param"><span class="n">filters</span></em>, <em class="sig-param"><span class="n">skip</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#UNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.UNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.models.Network" title="core.models.Network"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.models.Network</span></code></a></p>
<p>A PyTorch implementation of <a class="reference external" href="https://arxiv.org/abs/1505.04597">U-Net</a>.</p>
<dl class="simple">
<dt>Slightly modified version of U-Net:</dt><dd><ul class="simple">
<li><p>each convolution is followed by a batch normalization layer</p></li>
<li><p>the upsampling is implemented by a 2x2 max unpooling operation</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_channels</strong> (<cite>int</cite>) – Number of channels of the input images.</p></li>
<li><p><strong>nclasses</strong> (<cite>int</cite>) – Number of classes.</p></li>
<li><p><strong>filters</strong> (<cite>list</cite> [<cite>int</cite>]) – List of input channels to each convolutional block.</p></li>
<li><p><strong>skip</strong> (<cite>bool</cite>) – Whether to apply skip connections from the encoder to the decoder.</p></li>
<li><p><strong>**kwargs</strong> (‘dict’ [<cite>str</cite>]) – Additional keyword arguments passed to
<cite>pysegcnn.core.layers.Conv2dSame</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">state</span></code></dt><dd><p>Return the model state file.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">add_module</span></code>(name, module)</p></td>
<td><p>Adds a child module to the current module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">apply</span></code>(fn)</p></td>
<td><p>Applies <code class="docutils literal notranslate"><span class="pre">fn</span></code> recursively to every submodule (as returned by <code class="docutils literal notranslate"><span class="pre">.children()</span></code>) as well as self.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">bfloat16</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">bfloat16</span></code> datatype.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">buffers</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module buffers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpu</span></code>()</p></td>
<td><p>Moves all model parameters and buffers to the CPU.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">cuda</span></code>([device])</p></td>
<td><p>Moves all model parameters and buffers to the GPU.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">double</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">double</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">eval</span></code>()</p></td>
<td><p>Sets the module in evaluation mode.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">extra_repr</span></code>()</p></td>
<td><p>Set the extra representation of the module</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to float datatype.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.models.UNet.forward" title="core.models.UNet.forward"><code class="xref py py-obj docutils literal notranslate"><span class="pre">forward</span></code></a>(x)</p></td>
<td><p>Forward propagation of U-Net.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">freeze</span></code>()</p></td>
<td><p>Freeze the weights of a model.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">half</span></code>()</p></td>
<td><p>Casts all floating point parameters and buffers to <code class="docutils literal notranslate"><span class="pre">half</span></code> datatype.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load</span></code>(state_file)</p></td>
<td><p>Load a model state.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_state_dict</span></code>(state_dict[, strict])</p></td>
<td><p>Copies parameters and buffers from <code class="xref py py-attr docutils literal notranslate"><span class="pre">state_dict</span></code> into this module and its descendants.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">modules</span></code>()</p></td>
<td><p>Returns an iterator over all modules in the network.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_buffers</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module buffers, yielding both the name of the buffer as well as the buffer itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_children</span></code>()</p></td>
<td><p>Returns an iterator over immediate children modules, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_modules</span></code>([memo, prefix])</p></td>
<td><p>Returns an iterator over all modules in the network, yielding both the name of the module as well as the module itself.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">named_parameters</span></code>([prefix, recurse])</p></td>
<td><p>Returns an iterator over module parameters, yielding both the name of the parameter as well as the parameter itself.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parameters</span></code>([recurse])</p></td>
<td><p>Returns an iterator over module parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_backward_hook</span></code>(hook)</p></td>
<td><p>Registers a backward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_buffer</span></code>(name, tensor[, persistent])</p></td>
<td><p>Adds a buffer to the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_hook</span></code>(hook)</p></td>
<td><p>Registers a forward hook on the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_forward_pre_hook</span></code>(hook)</p></td>
<td><p>Registers a forward pre-hook on the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">register_parameter</span></code>(name, param)</p></td>
<td><p>Adds a parameter to the module.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">requires_grad_</span></code>([requires_grad])</p></td>
<td><p>Change if autograd should record operations on parameters in this module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">save</span></code>(state_file, optimizer[, bands])</p></td>
<td><p>Save the model state.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">state_dict</span></code>([destination, prefix, keep_vars])</p></td>
<td><p>Returns a dictionary containing a whole state of the module.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">to</span></code>(*args, **kwargs)</p></td>
<td><p>Moves and/or casts the parameters and buffers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code>([mode])</p></td>
<td><p>Sets the module in training mode.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code>(dst_type)</p></td>
<td><p>Casts all parameters and buffers to <code class="xref py py-attr docutils literal notranslate"><span class="pre">dst_type</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">unfreeze</span></code>()</p></td>
<td><p>Unfreeze the weights of a model.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">zero_grad</span></code>()</p></td>
<td><p>Sets gradients of all model parameters to zero.</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default">
<colgroup>
<col style="width: 62%" />
<col style="width: 38%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><strong>__call__</strong></p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><strong>share_memory</strong></p></td>
<td></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.models.UNet.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/models.html#UNet.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.models.UNet.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Forward propagation of U-Net.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<cite>torch.Tensor</cite>) – The input image, shape=(batch_size, channels, height, width).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>y</strong> – The classified image, shape=(batch_size, height, width).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>‘torch.tensor’</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.models.UNet.training">
<code class="sig-name descname">training</code><em class="property">: bool</em><a class="headerlink" href="#core.models.UNet.training" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-core.predict">
<span id="core-predict-module"></span><h2>core.predict module<a class="headerlink" href="#module-core.predict" title="Permalink to this headline">¶</a></h2>
<p>Functions for model inference.</p>
<div class="section" id="id8">
<h3>License<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py function">
<dt id="core.predict.predict_samples">
<code class="sig-prename descclassname">core.predict.</code><code class="sig-name descname">predict_samples</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">cm</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/predict.html#predict_samples"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.predict.predict_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Classify each sample in <code class="docutils literal notranslate"><span class="pre">ds</span></code> with model <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.split.RandomSubset</cite> or) – </p></li>
<li><p><strong>pysegcnn.core.split.SceneSubset</strong> – An instance of <cite>~pysegcnn.core.split.RandomSubset</cite> or
<cite>~pysegcnn.core.split.SceneSubset</cite>.</p></li>
<li><p><strong>model</strong> (<cite>pysegcnn.core.models.Network</cite>) – An instance of <cite>~pysegcnn.core.models.Network</cite>.</p></li>
<li><p><strong>cm</strong> (<cite>bool</cite>, optional) – Whether to compute the confusion matrix. The default is False.</p></li>
<li><p><strong>plot</strong> (<cite>bool</cite>, optional) – Whether to plot a false color composite, ground truth and model
prediction for each sample. The default is False.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to
<cite>pysegcnn.core.graphics.plot_sample</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">ds</span></code> is not an instance of
<cite>~pysegcnn.core.split.RandomSubset</cite> or
<cite>~pysegcnn.core.split.SceneSubset</cite>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul>
<li><p><strong>output</strong> (<cite>dict</cite>) –</p>
<dl class="simple">
<dt>Output dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'input'</span></code></dt><dd><p>Model input data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'labels'</span></code></dt><dd><p>The ground truth</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'prediction'</span></code></dt><dd><p>Model prediction</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p><strong>conf_mat</strong> (<cite>numpy.ndarray</cite>) – The confusion matrix. Note that the confusion matrix <code class="docutils literal notranslate"><span class="pre">conf_mat</span></code> is
only computed if <code class="docutils literal notranslate"><span class="pre">cm</span></code> = True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.predict.predict_scenes">
<code class="sig-prename descclassname">core.predict.</code><code class="sig-name descname">predict_scenes</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">scene_id</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cm</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/predict.html#predict_scenes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.predict.predict_scenes" title="Permalink to this definition">¶</a></dt>
<dd><p>Classify each scene in <code class="docutils literal notranslate"><span class="pre">ds</span></code> with model <code class="docutils literal notranslate"><span class="pre">model</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.split.SceneSubset</cite>) – An instance of <cite>~pysegcnn.core.split.SceneSubset</cite>.</p></li>
<li><p><strong>model</strong> (<cite>pysegcnn.core.models.Network</cite>) – An instance of <cite>~pysegcnn.core.models.Network</cite>.</p></li>
<li><p><strong>scene_id</strong> (<cite>str</cite> or <cite>None</cite>) – A valid scene identifier.</p></li>
<li><p><strong>cm</strong> (<cite>bool</cite>, optional) – Whether to compute the confusion matrix. The default is False.</p></li>
<li><p><strong>plot</strong> (<cite>bool</cite>, optional) – Whether to plot a false color composite, ground truth and model
prediction for each scene. The default is False.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to
<cite>pysegcnn.core.graphics.plot_sample</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">ds</span></code> is not an instance of
<cite>~pysegcnn.core.split.SceneSubset</cite>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul>
<li><p><strong>output</strong> (<cite>dict</cite>) –</p>
<dl class="simple">
<dt>Output dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'input'</span></code></dt><dd><p>Model input data</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'labels'</span></code></dt><dd><p>The ground truth</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'prediction'</span></code></dt><dd><p>Model prediction</p>
</dd>
</dl>
</dd>
</dl>
</li>
<li><p><strong>conf_mat</strong> (<cite>numpy.ndarray</cite>) – The confusion matrix. Note that the confusion matrix <code class="docutils literal notranslate"><span class="pre">conf_mat</span></code> is
only computed if <code class="docutils literal notranslate"><span class="pre">cm</span></code> = True.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-core.split">
<span id="core-split-module"></span><h2>core.split module<a class="headerlink" href="#module-core.split" title="Permalink to this headline">¶</a></h2>
<p>Split the dataset into training, validation and test set.</p>
<div class="section" id="id9">
<h3>License<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py class">
<dt id="core.split.CustomSubset">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">CustomSubset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dataset</span></em>, <em class="sig-param"><span class="n">indices</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#CustomSubset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.CustomSubset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.utils.data.dataset.Subset</span></code></p>
<p>Custom subset inheriting <cite>torch.utils.data.Subset</cite>.</p>
</dd></dl>

<dl class="py class">
<dt id="core.split.DateSplit">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">DateSplit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">dateformat</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#DateSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.DateSplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.split.Split" title="core.split.Split"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.split.Split</span></code></a></p>
<p>Split the dataset based on a date.</p>
<p>Class wrapper for <cite>pysegcnn.core.split.Split.date_scene_split</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>date</strong> (<em>'str'</em>) – A date.</p></li>
<li><p><strong>dateformat</strong> (<em>'str'</em><em>, </em><em>optional</em>) – The format of <code class="docutils literal notranslate"><span class="pre">date</span></code>. <code class="docutils literal notranslate"><span class="pre">dateformat</span></code> is used by
<cite>datetime.datetime.strptime’ to parse ``date`</cite> to a <cite>datetime.datetime</cite>
object. The default is ‘%Y%m%d’.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code>()</p></td>
<td><p>Split dataset into training, validation and test set.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.split.DateSplit.subset_type" title="core.split.DateSplit.subset_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset_type</span></code></a>()</p></td>
<td><p>Wrap <cite>pysegcnn.core.split.SceneSubset</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.split.DateSplit.subsets" title="core.split.DateSplit.subsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subsets</span></code></a>()</p></td>
<td><p>Wrap <cite>pysegcnn.core.split.Split.date_scene_split</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.split.DateSplit.subset_type">
<code class="sig-name descname">subset_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#DateSplit.subset_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.DateSplit.subset_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap <cite>pysegcnn.core.split.SceneSubset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>SceneSubset</strong> – The subset type.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pysegcnn.core.split.SceneSubset</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.split.DateSplit.subsets">
<code class="sig-name descname">subsets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#DateSplit.subsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.DateSplit.subsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap <cite>pysegcnn.core.split.Split.date_scene_split</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>subsets</strong> –</p>
<dl class="simple">
<dt>Subset dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'train'</span></code></dt><dd><p>dictionary containing the training scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'valid'</span></code></dt><dd><p>dictionary containing the validation scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'test'</span></code></dt><dd><p>dictionary containing the test scenes, empty.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.split.RandomSceneSplit">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">RandomSceneSplit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">ttratio</span></em>, <em class="sig-param"><span class="n">tvratio</span></em>, <em class="sig-param"><span class="n">seed</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomSceneSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomSceneSplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.split.RandomSplit" title="core.split.RandomSplit"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.split.RandomSplit</span></code></a></p>
<p>Randomly split the dataset.</p>
<p>For each scene, all the tiles of the scene are included in either the
training, validation or test set, respectively.</p>
<p>Class wrapper for <cite>pysegcnn.core.split.Split.random_scene_split</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>tvratio</strong> (<cite>float</cite>) – The ratio of training data to validation data, e.g. <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> = 0.8
means 80% training, 20% validation.</p></li>
<li><p><strong>ttratio</strong> (<cite>float</cite>, optional) – The ratio of training and validation data to test data, e.g.
<code class="docutils literal notranslate"><span class="pre">ttratio</span></code> = 0.6 means 60% for training and validation, 40% for
testing. The default is 1.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed for reproducibility. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code>()</p></td>
<td><p>Split dataset into training, validation and test set.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.split.RandomSceneSplit.subset_type" title="core.split.RandomSceneSplit.subset_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset_type</span></code></a>()</p></td>
<td><p>Wrap <cite>pysegcnn.core.split.SceneSubset</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.split.RandomSceneSplit.subsets" title="core.split.RandomSceneSplit.subsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subsets</span></code></a>()</p></td>
<td><p>Wrap <cite>pysegcnn.core.split.Split.random_scene_split</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.split.RandomSceneSplit.subset_type">
<code class="sig-name descname">subset_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomSceneSplit.subset_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomSceneSplit.subset_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap <cite>pysegcnn.core.split.SceneSubset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>SceneSubset</strong> – The subset type.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pysegcnn.core.split.SceneSubset</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.split.RandomSceneSplit.subsets">
<code class="sig-name descname">subsets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomSceneSplit.subsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomSceneSplit.subsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap <cite>pysegcnn.core.split.Split.random_scene_split</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>subsets</strong> –</p>
<dl class="simple">
<dt>Subset dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'train'</span></code></dt><dd><p>dictionary containing the training scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'valid'</span></code></dt><dd><p>dictionary containing the validation scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'test'</span></code></dt><dd><p>dictionary containing the test scenes, empty.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.split.RandomSplit">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">RandomSplit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">ttratio</span></em>, <em class="sig-param"><span class="n">tvratio</span></em>, <em class="sig-param"><span class="n">seed</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomSplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.split.Split" title="core.split.Split"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.split.Split</span></code></a></p>
<p>Randomly split the dataset.</p>
<p>Generic class for random dataset splits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>tvratio</strong> (<cite>float</cite>) – The ratio of training data to validation data, e.g. <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> = 0.8
means 80% training, 20% validation.</p></li>
<li><p><strong>ttratio</strong> (<cite>float</cite>, optional) – The ratio of training and validation data to test data, e.g.
<code class="docutils literal notranslate"><span class="pre">ttratio</span></code> = 0.6 means 60% for training and validation, 40% for
testing. The default is 1.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed for reproducibility. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code>()</p></td>
<td><p>Split dataset into training, validation and test set.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset_type</span></code>()</p></td>
<td><p>Define the type of each subset.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">subsets</span></code>()</p></td>
<td><p>Define training, validation and test sets.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="core.split.RandomSubset">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">RandomSubset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">indices</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">scenes</span></em>, <em class="sig-param"><span class="n">scene_ids</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomSubset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomSubset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.split.CustomSubset" title="core.split.CustomSubset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.split.CustomSubset</span></code></a></p>
<p>A custom subset for random dataset splits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>indices</strong> (<cite>list</cite> [<cite>int</cite>]) – List of the subset indices to access <code class="docutils literal notranslate"><span class="pre">ds</span></code>.</p></li>
<li><p><strong>name</strong> (<cite>str</cite>) – Name of the subset.</p></li>
<li><p><strong>scenes</strong> (<cite>list</cite> [<cite>dict</cite>]) – List of the subset tiles.</p></li>
<li><p><strong>scene_ids</strong> (<cite>list</cite> or <cite>numpy.ndarray</cite>) – Container of the scene ids.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="core.split.RandomTileSplit">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">RandomTileSplit</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">ttratio</span></em>, <em class="sig-param"><span class="n">tvratio</span></em>, <em class="sig-param"><span class="n">seed</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomTileSplit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomTileSplit" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.split.RandomSplit" title="core.split.RandomSplit"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.split.RandomSplit</span></code></a></p>
<p>Randomly split the dataset.</p>
<p>For each scene, the tiles of the scene can be distributed among the
training, validation and test set.</p>
<p>Class wrapper for <cite>pysegcnn.core.split.Split.random_tile_split</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>tvratio</strong> (<cite>float</cite>) – The ratio of training data to validation data, e.g. <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> = 0.8
means 80% training, 20% validation.</p></li>
<li><p><strong>ttratio</strong> (<cite>float</cite>, optional) – The ratio of training and validation data to test data, e.g.
<code class="docutils literal notranslate"><span class="pre">ttratio</span></code> = 0.6 means 60% for training and validation, 40% for
testing. The default is 1.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed for reproducibility. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code>()</p></td>
<td><p>Split dataset into training, validation and test set.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.split.RandomTileSplit.subset_type" title="core.split.RandomTileSplit.subset_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset_type</span></code></a>()</p></td>
<td><p>Wrap <cite>pysegcnn.core.split.RandomSubset</cite>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.split.RandomTileSplit.subsets" title="core.split.RandomTileSplit.subsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subsets</span></code></a>()</p></td>
<td><p>Wrap <cite>pysegcnn.core.split.Split.random_tile_split</cite>.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.split.RandomTileSplit.subset_type">
<code class="sig-name descname">subset_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomTileSplit.subset_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomTileSplit.subset_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap <cite>pysegcnn.core.split.RandomSubset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>SceneSubset</strong> – The subset type.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pysegcnn.core.split.RandomSubset</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.split.RandomTileSplit.subsets">
<code class="sig-name descname">subsets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#RandomTileSplit.subsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.RandomTileSplit.subsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrap <cite>pysegcnn.core.split.Split.random_tile_split</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>subsets</strong> –</p>
<dl class="simple">
<dt>Subset dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'train'</span></code></dt><dd><p>dictionary containing the training scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'valid'</span></code></dt><dd><p>dictionary containing the validation scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'test'</span></code></dt><dd><p>dictionary containing the test scenes, empty.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.split.SceneSubset">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">SceneSubset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">indices</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">scenes</span></em>, <em class="sig-param"><span class="n">scene_ids</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#SceneSubset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.SceneSubset" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.split.CustomSubset" title="core.split.CustomSubset"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.split.CustomSubset</span></code></a></p>
<p>A custom subset for dataset splits where the scenes are preserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>indices</strong> (<cite>list</cite> [<cite>int</cite>]) – List of the subset indices to access <code class="docutils literal notranslate"><span class="pre">ds</span></code>.</p></li>
<li><p><strong>name</strong> (<cite>str</cite>) – Name of the subset.</p></li>
<li><p><strong>scenes</strong> (<cite>list</cite> [<cite>dict</cite>]) – List of the subset tiles.</p></li>
<li><p><strong>scene_ids</strong> (<cite>list</cite> or <cite>numpy.ndarray</cite>) – Container of the scene ids.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt id="core.split.Split">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">Split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#Split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.Split" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generic class handling how <code class="docutils literal notranslate"><span class="pre">ds</span></code> is split.</p>
<p>Inherit <cite>~pysegcnn.core.split.Split</cite> and implement the
<cite>~pysegcnn.core.split.Split.subsets</cite> and
<cite>~pysegcnn.core.split.Split.subset_type</cite> method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.split.Split.split" title="core.split.Split.split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">split</span></code></a>()</p></td>
<td><p>Split dataset into training, validation and test set.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.split.Split.subset_type" title="core.split.Split.subset_type"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subset_type</span></code></a>()</p></td>
<td><p>Define the type of each subset.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.split.Split.subsets" title="core.split.Split.subsets"><code class="xref py py-obj docutils literal notranslate"><span class="pre">subsets</span></code></a>()</p></td>
<td><p>Define training, validation and test sets.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.split.Split.split">
<code class="sig-name descname">split</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#Split.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.Split.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split dataset into training, validation and test set.</p>
<p><cite>~pysegcnn.core.split.Split.split</cite> works only if
<cite>~pysegcnn.core.split.Split.subsets</cite> and
<cite>~pysegcnn.core.split.Split.subset_type</cite> are implemented.</p>
</dd></dl>

<dl class="py method">
<dt id="core.split.Split.subset_type">
<code class="sig-name descname">subset_type</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#Split.subset_type"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.Split.subset_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Define the type of each subset.</p>
<p>Wrapper method for
<cite>pysegcnn.core.split.RandomSubset</cite> or
<cite>pysegcnn.core.split.SceneSubset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if <cite>pysegcnn.core.split.Split</cite> is not inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.split.Split.subsets">
<code class="sig-name descname">subsets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#Split.subsets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.Split.subsets" title="Permalink to this definition">¶</a></dt>
<dd><p>Define training, validation and test sets.</p>
<p>Wrapper method for
<cite>pysegcnn.core.split.Split.random_tile_split</cite>,
<cite>pysegcnn.core.split.Split.random_scene_split</cite> or
<cite>pysegcnn.core.split.Split.date_scene_split</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – Raised if <cite>pysegcnn.core.split.Split</cite> is not inherited.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.split.SupportedSplits">
<em class="property">class </em><code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">SupportedSplits</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">value</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#SupportedSplits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.SupportedSplits" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Names and corresponding classes of the implemented split modes.</p>
<dl class="py attribute">
<dt id="core.split.SupportedSplits.date">
<code class="sig-name descname">date</code><em class="property"> = &lt;class 'core.split.DateSplit'&gt;</em><a class="headerlink" href="#core.split.SupportedSplits.date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.split.SupportedSplits.random">
<code class="sig-name descname">random</code><em class="property"> = &lt;class 'core.split.RandomTileSplit'&gt;</em><a class="headerlink" href="#core.split.SupportedSplits.random" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.split.SupportedSplits.scene">
<code class="sig-name descname">scene</code><em class="property"> = &lt;class 'core.split.RandomSceneSplit'&gt;</em><a class="headerlink" href="#core.split.SupportedSplits.scene" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="core.split.date_scene_split">
<code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">date_scene_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">date</span></em>, <em class="sig-param"><span class="n">dateformat</span><span class="o">=</span><span class="default_value">'%Y%m%d'</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#date_scene_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.date_scene_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split the dataset based on a date.</p>
<p>Scenes before <code class="docutils literal notranslate"><span class="pre">date</span></code> build the training set, scenes after <code class="docutils literal notranslate"><span class="pre">date</span></code> build
the validation set, the test set is empty.</p>
<p>Useful for time series data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>date</strong> (<cite>str</cite>) – A date.</p></li>
<li><p><strong>dateformat</strong> (<cite>str</cite>, optional) – The format of <code class="docutils literal notranslate"><span class="pre">date</span></code>. <code class="docutils literal notranslate"><span class="pre">dateformat</span></code> is used by
<cite>datetime.datetime.strptime’ to parse ``date`</cite> to a <cite>datetime.datetime</cite>
object. The default is ‘%Y%m%d’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>AssertionError</strong> – Raised if the splits are not pairwise disjoint.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>subsets</strong> –</p>
<dl class="simple">
<dt>Subset dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'train'</span></code></dt><dd><p>dictionary containing the training scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'valid'</span></code></dt><dd><p>dictionary containing the validation scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'test'</span></code></dt><dd><p>dictionary containing the test scenes, empty.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.split.pairwise_disjoint">
<code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">pairwise_disjoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sets</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#pairwise_disjoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.pairwise_disjoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if <code class="docutils literal notranslate"><span class="pre">sets</span></code> are pairwise disjoint.</p>
<p>Sets are pairwise disjoint if the length of their union equals the sum of
their lengths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>sets</strong> (<cite>list</cite> [<cite>collections.Sized</cite>]) – A list of sized objects.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>disjoint</strong> – Whether the sets are pairwise disjoint.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.split.random_scene_split">
<code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">random_scene_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">tvratio</span></em>, <em class="sig-param"><span class="n">ttratio</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#random_scene_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.random_scene_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly split the tiles of a dataset.</p>
<p>For each scene, all the tiles of the scene are included in either the
training, validation or test set, respectively.</p>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">ttratio</span></code> and <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> control the size of the
training, validation and test datasets.</p>
<p>Test dataset size      : (1 - <code class="docutils literal notranslate"><span class="pre">ttratio</span></code>) * len(<code class="docutils literal notranslate"><span class="pre">ds</span></code>)
Train dataset size     : <code class="docutils literal notranslate"><span class="pre">ttratio</span></code> * <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> * len(<code class="docutils literal notranslate"><span class="pre">ds</span></code>)
Validation dataset size: <code class="docutils literal notranslate"><span class="pre">ttratio</span></code> * (1 - <code class="docutils literal notranslate"><span class="pre">tvratio</span></code>) * len(<code class="docutils literal notranslate"><span class="pre">ds</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>tvratio</strong> (<cite>float</cite>) – The ratio of training data to validation data, e.g. <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> = 0.8
means 80% training, 20% validation.</p></li>
<li><p><strong>ttratio</strong> (<cite>float</cite>, optional) – The ratio of training and validation data to test data, e.g.
<code class="docutils literal notranslate"><span class="pre">ttratio</span></code> = 0.6 means 60% for training and validation, 40% for
testing. The default is 1.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed for reproducibility. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>AssertionError</strong> – Raised if the splits are not pairwise disjoint.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>subsets</strong> –</p>
<dl class="simple">
<dt>Subset dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'train'</span></code></dt><dd><p>dictionary containing the training scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'valid'</span></code></dt><dd><p>dictionary containing the validation scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'test'</span></code></dt><dd><p>dictionary containing the test scenes.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.split.random_tile_split">
<code class="sig-prename descclassname">core.split.</code><code class="sig-name descname">random_tile_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">tvratio</span></em>, <em class="sig-param"><span class="n">ttratio</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">seed</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/split.html#random_tile_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.split.random_tile_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly split the tiles of a dataset.</p>
<p>For each scene, the tiles of the scene can be distributed among the
training, validation and test set.</p>
<p>The parameters <code class="docutils literal notranslate"><span class="pre">ttratio</span></code> and <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> control the size of the
training, validation and test datasets.</p>
<p>Test dataset size      : (1 - <code class="docutils literal notranslate"><span class="pre">ttratio</span></code>) * len(<code class="docutils literal notranslate"><span class="pre">ds</span></code>)
Train dataset size     : <code class="docutils literal notranslate"><span class="pre">ttratio</span></code> * <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> * len(<code class="docutils literal notranslate"><span class="pre">ds</span></code>)
Validation dataset size: <code class="docutils literal notranslate"><span class="pre">ttratio</span></code> * (1 - <code class="docutils literal notranslate"><span class="pre">tvratio</span></code>) * len(<code class="docutils literal notranslate"><span class="pre">ds</span></code>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>~pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>tvratio</strong> (<cite>float</cite>) – The ratio of training data to validation data, e.g. <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> = 0.8
means 80% training, 20% validation.</p></li>
<li><p><strong>ttratio</strong> (<cite>float</cite>, optional) – The ratio of training and validation data to test data, e.g.
<code class="docutils literal notranslate"><span class="pre">ttratio</span></code> = 0.6 means 60% for training and validation, 40% for
testing. The default is 1.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>, optional) – The random seed for reproducibility. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>AssertionError</strong> – Raised if the splits are not pairwise disjoint.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>subsets</strong> –</p>
<dl class="simple">
<dt>Subset dictionary with keys:</dt><dd><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'train'</span></code></dt><dd><p>dictionary containing the training scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'valid'</span></code></dt><dd><p>dictionary containing the validation scenes.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'test'</span></code></dt><dd><p>dictionary containing the test scenes.</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-core.trainer">
<span id="core-trainer-module"></span><h2>core.trainer module<a class="headerlink" href="#module-core.trainer" title="Permalink to this headline">¶</a></h2>
<p>Model configuration and training.</p>
<p>This module provides an end-to-end framework of dataclasses designed to train
segmentation models on image datasets.</p>
<p>See pysegcnn/main/train.py for a complete walkthrough.</p>
<div class="section" id="id10">
<h3>License<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py class">
<dt id="core.trainer.BaseConfig">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">BaseConfig</code><a class="reference internal" href="../_modules/core/trainer.html#BaseConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.BaseConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base <cite>dataclasses.dataclass</cite> for each configuration.</p>
</dd></dl>

<dl class="py class">
<dt id="core.trainer.DatasetConfig">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">DatasetConfig</code><span class="sig-paren">(</span><em class="sig-param">dataset_name: str</em>, <em class="sig-param">root_dir: pathlib.Path</em>, <em class="sig-param">bands: list</em>, <em class="sig-param">tile_size: int</em>, <em class="sig-param">gt_pattern: str</em>, <em class="sig-param">seed: int</em>, <em class="sig-param">sort: bool = False</em>, <em class="sig-param">transforms: list = &lt;factory&gt;</em>, <em class="sig-param">pad: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#DatasetConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.DatasetConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.trainer.BaseConfig" title="core.trainer.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.trainer.BaseConfig</span></code></a></p>
<p>Dataset configuration class.</p>
<p>Instanciate a dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset_name</strong> (<cite>str</cite>) – The name of the dataset.</p></li>
<li><p><strong>root_dir</strong> (<cite>pathlib.Path</cite>) – The root directory, path to the dataset.</p></li>
<li><p><strong>bands</strong> (<cite>list</cite> [<cite>str</cite>]) – A list of the spectral bands to use.</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite>) – The size of the tiles. Each scene is divided into square tiles of shape
(tile_size, tile_size).</p></li>
<li><p><strong>gt_pattern</strong> (<cite>str</cite>) – A pattern to match the ground truth naming convention. All directories
and subdirectories in <code class="docutils literal notranslate"><span class="pre">root_dir</span></code> are searched for files matching
<code class="docutils literal notranslate"><span class="pre">gt_pattern</span></code>.</p></li>
<li><p><strong>seed</strong> (<cite>int</cite>) – The random seed. Used to split the dataset into training, validation
and test set. Useful for reproducibility. The default is 0.</p></li>
<li><p><strong>sort</strong> (<cite>bool</cite>, optional) – Whether to chronologically sort the samples. Useful for time series
data. The default is False.</p></li>
<li><p><strong>transforms</strong> (<cite>list</cite> [<cite>pysegcnn.core.split.Augment</cite>], optional) – List of <cite>pysegcnn.core.split.Augment</cite> instances. Each item in
<code class="docutils literal notranslate"><span class="pre">transforms</span></code> generates a distinct transformed version of the dataset.
The total dataset is composed of the original untransformed dataset
together with each transformed version of it.
If <code class="docutils literal notranslate"><span class="pre">transforms</span></code> = [], only the original dataset is used.
The default is [].</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. Set <code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, if the
images are not evenly divisible by the <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>. The image data is
padded with a constant padding value of zero. For each image, the
corresponding ground truth image is padded with a “no data” label.
The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.DatasetConfig.init_dataset" title="core.trainer.DatasetConfig.init_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_dataset</span></code></a>()</p></td>
<td><p>Instanciate the dataset.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.bands">
<code class="sig-name descname">bands</code><em class="property">: list</em><a class="headerlink" href="#core.trainer.DatasetConfig.bands" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.dataset_name">
<code class="sig-name descname">dataset_name</code><em class="property">: str</em><a class="headerlink" href="#core.trainer.DatasetConfig.dataset_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.gt_pattern">
<code class="sig-name descname">gt_pattern</code><em class="property">: str</em><a class="headerlink" href="#core.trainer.DatasetConfig.gt_pattern" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.DatasetConfig.init_dataset">
<code class="sig-name descname">init_dataset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#DatasetConfig.init_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.DatasetConfig.init_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Instanciate the dataset.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>dataset</strong> – An instance of <cite>pysegcnn.core.dataset.ImageDataset</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pysegcnn.core.dataset.ImageDataset</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.pad">
<code class="sig-name descname">pad</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.DatasetConfig.pad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.root_dir">
<code class="sig-name descname">root_dir</code><em class="property">: pathlib.Path</em><a class="headerlink" href="#core.trainer.DatasetConfig.root_dir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.seed">
<code class="sig-name descname">seed</code><em class="property">: int</em><a class="headerlink" href="#core.trainer.DatasetConfig.seed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.sort">
<code class="sig-name descname">sort</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.DatasetConfig.sort" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.tile_size">
<code class="sig-name descname">tile_size</code><em class="property">: int</em><a class="headerlink" href="#core.trainer.DatasetConfig.tile_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.DatasetConfig.transforms">
<code class="sig-name descname">transforms</code><em class="property">: list</em><a class="headerlink" href="#core.trainer.DatasetConfig.transforms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.trainer.EarlyStopping">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">EarlyStopping</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'max'</span></em>, <em class="sig-param"><span class="n">best</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">min_delta</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">patience</span><span class="o">=</span><span class="default_value">10</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#EarlyStopping"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.EarlyStopping" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p><a href="#id25"><span class="problematic" id="id26">`Early stopping`_</span></a> algorithm.</p>
<p>This implementation of the early stopping algorithm advances a counter each
time a metric did not improve over a training epoch. If the metric does not
improve over more than <code class="docutils literal notranslate"><span class="pre">patience</span></code> epochs, the early stopping criterion is
met.</p>
<p>See <cite>pysegcnn.core.trainer.NetworkTrainer.train</cite> for an example
implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<cite>str</cite>, optional) – The mode of the early stopping. Depends on the metric measuring
performance. When using model loss as metric, use <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘min’,
however, when using accuracy as metric, use <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘max’. The
default is ‘max’.</p></li>
<li><p><strong>best</strong> (<cite>float</cite>, optional) – Threshold indicating the best metric score. At instanciation, set
<code class="docutils literal notranslate"><span class="pre">best</span></code> to the worst possible score of the metric. <code class="docutils literal notranslate"><span class="pre">best</span></code> will be
overwritten during training. The default is 0.</p></li>
<li><p><strong>min_delta</strong> (<cite>float</cite>, optional) – Minimum change in early stopping metric to be considered as an
improvement. The default is 0.</p></li>
<li><p><strong>patience</strong> (<cite>int</cite>, optional) – The number of epochs to wait for an improvement in the early stopping
metric. The default is 10.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">mode</span></code> is not either ‘min’ or ‘max’.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>None.</em></p></li>
<li><p><em>.. _Early stopping</em> – <a class="reference external" href="https://en.wikipedia.org/wiki/Early_stopping">https://en.wikipedia.org/wiki/Early_stopping</a></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.EarlyStopping.decreased" title="core.trainer.EarlyStopping.decreased"><code class="xref py py-obj docutils literal notranslate"><span class="pre">decreased</span></code></a>(metric, best, min_delta)</p></td>
<td><p>Whether a metric decreased with respect to a best score.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.trainer.EarlyStopping.increased" title="core.trainer.EarlyStopping.increased"><code class="xref py py-obj docutils literal notranslate"><span class="pre">increased</span></code></a>(metric, best, min_delta)</p></td>
<td><p>Whether a metric increased with respect to a best score.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.EarlyStopping.stop" title="core.trainer.EarlyStopping.stop"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stop</span></code></a>(metric)</p></td>
<td><p>Advance early stopping counter.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.trainer.EarlyStopping.decreased">
<code class="sig-name descname">decreased</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric</span></em>, <em class="sig-param"><span class="n">best</span></em>, <em class="sig-param"><span class="n">min_delta</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#EarlyStopping.decreased"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.EarlyStopping.decreased" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether a metric decreased with respect to a best score.</p>
<p>Measure improvement for metrics that are considered as ‘better’ when
they decrease, e.g. model loss, mean squared error, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<cite>float</cite>) – The current score.</p></li>
<li><p><strong>best</strong> (<cite>float</cite>) – The current best score.</p></li>
<li><p><strong>min_delta</strong> (<cite>float</cite>) – Minimum change to be considered as an improvement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the metric improved.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.trainer.EarlyStopping.increased">
<code class="sig-name descname">increased</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric</span></em>, <em class="sig-param"><span class="n">best</span></em>, <em class="sig-param"><span class="n">min_delta</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#EarlyStopping.increased"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.EarlyStopping.increased" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether a metric increased with respect to a best score.</p>
<p>Measure improvement for metrics that are considered as ‘better’ when
they increase, e.g. accuracy, precision, recall, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metric</strong> (<cite>float</cite>) – The current score.</p></li>
<li><p><strong>best</strong> (<cite>float</cite>) – The current best score.</p></li>
<li><p><strong>min_delta</strong> (<cite>float</cite>) – Minimum change to be considered as an improvement.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the metric improved.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.trainer.EarlyStopping.stop">
<code class="sig-name descname">stop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metric</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#EarlyStopping.stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.EarlyStopping.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Advance early stopping counter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric</strong> (<cite>float</cite>) – The current metric score.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>early_stop</strong> – Whether the early stopping criterion is met.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>bool</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.trainer.EvalConfig">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">EvalConfig</code><span class="sig-paren">(</span><em class="sig-param">state_file: pathlib.Path</em>, <em class="sig-param">test: object</em>, <em class="sig-param">predict_scene: bool = False</em>, <em class="sig-param">plot_samples: bool = False</em>, <em class="sig-param">plot_scenes: bool = False</em>, <em class="sig-param">plot_bands: list = &lt;factory&gt;</em>, <em class="sig-param">cm: bool = True</em>, <em class="sig-param">figsize: tuple = (10</em>, <em class="sig-param">10)</em>, <em class="sig-param">alpha: int = 5</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#EvalConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.EvalConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.trainer.BaseConfig" title="core.trainer.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.trainer.BaseConfig</span></code></a></p>
<p>Model inference configuration.</p>
<p>Evaluate a model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_file</strong> (<cite>pathlib.Path</cite>) – Path to the model to evaluate.</p></li>
<li><p><strong>test</strong> (<cite>bool</cite> or <cite>None</cite>) – Whether to evaluate the model on the training(<code class="docutils literal notranslate"><span class="pre">test</span></code> = <cite>None</cite>), the
validation (<code class="docutils literal notranslate"><span class="pre">test</span></code> = False) or the test set (<code class="docutils literal notranslate"><span class="pre">test</span></code> = True).</p></li>
<li><p><strong>predict_scene</strong> (<cite>bool</cite>, optional) – The model prediction order. If False, the samples (tiles) of a dataset
are predicted in any order and the scenes are not reconstructed.
If True, the samples (tiles) are ordered according to the scene they
belong to and a model prediction for each entire reconstructed scene is
returned. The default is False.</p></li>
<li><p><strong>plot_samples</strong> (<cite>bool</cite>, optional) – Whether to save a plot of false color composite, ground truth and model
prediction for each sample (tile). Only used if <code class="docutils literal notranslate"><span class="pre">predict_scene</span></code> =
False. The default is False.</p></li>
<li><p><strong>plot_scenes</strong> (<cite>bool</cite>, optional) – Whether to save a plot of false color composite, ground truth and model
prediction for each entire scene. Only used if <code class="docutils literal notranslate"><span class="pre">predict_scene</span></code> =
True. The default is False.</p></li>
<li><p><strong>plot_bands</strong> (<cite>list</cite> [<cite>str</cite>], optional) – The bands to build the false color composite. The default is
[‘nir’, ‘red’, ‘green’].</p></li>
<li><p><strong>cm</strong> (<cite>bool</cite>, optional) – Whether to compute and plot the confusion matrix. The default is True.</p></li>
<li><p><strong>figsize</strong> (<cite>tuple</cite>, optional) – The figure size in centimeters. The default is (10, 10).</p></li>
<li><p><strong>alpha</strong> (<cite>int</cite>, optional) – The level of the percentiles for contrast stretching of the false color
compsite. The default is 0, i.e. no stretching.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="core.trainer.EvalConfig.alpha">
<code class="sig-name descname">alpha</code><em class="property">: int</em><em class="property"> = 5</em><a class="headerlink" href="#core.trainer.EvalConfig.alpha" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.cm">
<code class="sig-name descname">cm</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#core.trainer.EvalConfig.cm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.figsize">
<code class="sig-name descname">figsize</code><em class="property">: tuple</em><em class="property"> = (10, 10)</em><a class="headerlink" href="#core.trainer.EvalConfig.figsize" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.plot_bands">
<code class="sig-name descname">plot_bands</code><em class="property">: list</em><a class="headerlink" href="#core.trainer.EvalConfig.plot_bands" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.plot_samples">
<code class="sig-name descname">plot_samples</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.EvalConfig.plot_samples" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.plot_scenes">
<code class="sig-name descname">plot_scenes</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.EvalConfig.plot_scenes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.predict_scene">
<code class="sig-name descname">predict_scene</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.EvalConfig.predict_scene" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.state_file">
<code class="sig-name descname">state_file</code><em class="property">: pathlib.Path</em><a class="headerlink" href="#core.trainer.EvalConfig.state_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.EvalConfig.test">
<code class="sig-name descname">test</code><em class="property">: object</em><a class="headerlink" href="#core.trainer.EvalConfig.test" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.trainer.LogConfig">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">LogConfig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_file</span><span class="p">:</span> <span class="n">pathlib.Path</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#LogConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.LogConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.trainer.BaseConfig" title="core.trainer.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.trainer.BaseConfig</span></code></a></p>
<p>Logging configuration class.</p>
<p>Generate the model log file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_file</strong> (<cite>pathlib.Path</cite>) – Path to a model state file.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.LogConfig.init_log" title="core.trainer.LogConfig.init_log"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_log</span></code></a>(init_str)</p></td>
<td><p>Generate a string to identify a new model run.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.trainer.LogConfig.now" title="core.trainer.LogConfig.now"><code class="xref py py-obj docutils literal notranslate"><span class="pre">now</span></code></a>()</p></td>
<td><p>Return the current date and time.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.trainer.LogConfig.init_log">
<em class="property">static </em><code class="sig-name descname">init_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_str</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#LogConfig.init_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.LogConfig.init_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a string to identify a new model run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init_str</strong> (<cite>str</cite>) – The string to write to the model log file.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.trainer.LogConfig.now">
<em class="property">static </em><code class="sig-name descname">now</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#LogConfig.now"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.LogConfig.now" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current date and time.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>date</strong> – The current date and time.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>datetime.datetime</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.LogConfig.state_file">
<code class="sig-name descname">state_file</code><em class="property">: pathlib.Path</em><a class="headerlink" href="#core.trainer.LogConfig.state_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.trainer.ModelConfig">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">ModelConfig</code><span class="sig-paren">(</span><em class="sig-param">model_name: str</em>, <em class="sig-param">filters: list</em>, <em class="sig-param">torch_seed: int</em>, <em class="sig-param">optim_name: str</em>, <em class="sig-param">loss_name: str</em>, <em class="sig-param">skip_connection: bool = True</em>, <em class="sig-param">kwargs: dict = &lt;factory&gt;</em>, <em class="sig-param">batch_size: int = 64</em>, <em class="sig-param">checkpoint: bool = False</em>, <em class="sig-param">transfer: bool = False</em>, <em class="sig-param">pretrained_model: str = ''</em>, <em class="sig-param">lr: float = 0.001</em>, <em class="sig-param">early_stop: bool = False</em>, <em class="sig-param">mode: str = 'max'</em>, <em class="sig-param">delta: float = 0</em>, <em class="sig-param">patience: int = 10</em>, <em class="sig-param">epochs: int = 50</em>, <em class="sig-param">nthreads: int = 2</em>, <em class="sig-param">save: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#ModelConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.ModelConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.trainer.BaseConfig" title="core.trainer.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.trainer.BaseConfig</span></code></a></p>
<p>Model configuration class.</p>
<p>Instanciate a (pretrained) model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_name</strong> (<cite>str</cite>) – The name of the model.</p></li>
<li><p><strong>filters</strong> (<cite>list</cite> [<cite>int</cite>]) – List of input channels to the convolutional layers.</p></li>
<li><p><strong>torch_seed</strong> (<cite>int</cite>) – The random seed to initialize the model weights.
Useful for reproducibility.</p></li>
<li><p><strong>optim_name</strong> (<cite>str</cite>) – The name of the optimizer to update the model weights.</p></li>
<li><p><strong>loss_name</strong> (<cite>str</cite>) – The name of the loss function measuring the model error.</p></li>
<li><p><strong>skip_connection</strong> (<cite>bool</cite>, optional) – Whether to apply skip connections. The defaul is True.</p></li>
<li><p><strong>kwargs</strong> (<cite>dict</cite>, optional) – The configuration for each convolution in the model. The default is
{‘kernel_size’: 3, ‘stride’: 1, ‘dilation’: 1}.</p></li>
<li><p><strong>batch_size</strong> (<cite>int</cite>, optional) – The model batch size. Determines the number of samples to process
before updating the model weights. The default is 64.</p></li>
<li><p><strong>checkpoint</strong> (<cite>bool</cite>, optional) – Whether to resume training from an existing model checkpoint. The
default is False.</p></li>
<li><p><strong>transfer</strong> (<cite>bool</cite>, optional) – Whether to use a model for transfer learning on a new dataset. If True,
the model architecture of <code class="docutils literal notranslate"><span class="pre">pretrained_model</span></code> is adjusted to a new
dataset. The default is False.</p></li>
<li><p><strong>pretrained_model</strong> (<cite>str</cite>, optional) – The name of the pretrained model to use for transfer learning.
The default is ‘’.</p></li>
<li><p><strong>lr</strong> (<cite>float</cite>, optional) – The learning rate used by the gradient descent algorithm.
The default is 0.001.</p></li>
<li><p><strong>early_stop</strong> (<cite>bool</cite>, optional) – Whether to apply <a href="#id27"><span class="problematic" id="id28">`early stopping`_</span></a>. The default is False.</p></li>
<li><p><strong>mode</strong> (<cite>str</cite>, optional) – The mode of the early stopping. Depends on the metric measuring
performance. When using model loss as metric, use <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘min’,
however, when using accuracy as metric, use <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘max’. For now,
only <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘max’ is supported. Only used if <code class="docutils literal notranslate"><span class="pre">early_stop</span></code> = True.
The default is ‘max’.</p></li>
<li><p><strong>delta</strong> (<cite>float</cite>, optional) – Minimum change in early stopping metric to be considered as an
improvement. Only used if <code class="docutils literal notranslate"><span class="pre">early_stop</span></code> = True. The default is 0.</p></li>
<li><p><strong>patience</strong> (<cite>int</cite>, optional) – The number of epochs to wait for an improvement in the early stopping
metric. If the model does not improve over more than <code class="docutils literal notranslate"><span class="pre">patience</span></code>
epochs, quit training. Only used if <code class="docutils literal notranslate"><span class="pre">early_stop</span></code> = True.
The default is 10.</p></li>
<li><p><strong>epochs</strong> (<cite>int</cite>, optional) – The maximum number of epochs to train. The default is 50.</p></li>
<li><p><strong>nthreads</strong> (<cite>int</cite>, optional) – The number of cpu threads to use during training. The default is
torch.get_num_threads().</p></li>
<li><p><strong>save</strong> (<cite>bool</cite>, optional) – Whether to save the model state to disk. Model states are saved in
pysegcnn/main/_models. The default is True.</p></li>
<li><p><strong>_early stopping</strong> (<em>.</em>) – <a class="reference external" href="https://en.wikipedia.org/wiki/Early_stopping">https://en.wikipedia.org/wiki/Early_stopping</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.ModelConfig.init_loss_function" title="core.trainer.ModelConfig.init_loss_function"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_loss_function</span></code></a>()</p></td>
<td><p>Instanciate the loss function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.trainer.ModelConfig.init_model" title="core.trainer.ModelConfig.init_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_model</span></code></a>(ds, state_file)</p></td>
<td><p>Instanciate the model and the optimizer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.ModelConfig.init_optimizer" title="core.trainer.ModelConfig.init_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_optimizer</span></code></a>(model)</p></td>
<td><p>Instanciate the optimizer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.trainer.ModelConfig.load_checkpoint" title="core.trainer.ModelConfig.load_checkpoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_checkpoint</span></code></a>(model, optimizer, state_file)</p></td>
<td><p>Load an existing model checkpoint.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.ModelConfig.transfer_model" title="core.trainer.ModelConfig.transfer_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">transfer_model</span></code></a>(state_file, ds)</p></td>
<td><p>Adjust a pretrained model to a new dataset.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="core.trainer.ModelConfig.batch_size">
<code class="sig-name descname">batch_size</code><em class="property">: int</em><em class="property"> = 64</em><a class="headerlink" href="#core.trainer.ModelConfig.batch_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.checkpoint">
<code class="sig-name descname">checkpoint</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.ModelConfig.checkpoint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.delta">
<code class="sig-name descname">delta</code><em class="property">: float</em><em class="property"> = 0</em><a class="headerlink" href="#core.trainer.ModelConfig.delta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.early_stop">
<code class="sig-name descname">early_stop</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.ModelConfig.early_stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.epochs">
<code class="sig-name descname">epochs</code><em class="property">: int</em><em class="property"> = 50</em><a class="headerlink" href="#core.trainer.ModelConfig.epochs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.filters">
<code class="sig-name descname">filters</code><em class="property">: list</em><a class="headerlink" href="#core.trainer.ModelConfig.filters" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.ModelConfig.init_loss_function">
<code class="sig-name descname">init_loss_function</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#ModelConfig.init_loss_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.ModelConfig.init_loss_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Instanciate the loss function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>loss_function</strong> – An instance of <cite>torch.nn.Module</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>torch.nn.Module</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.trainer.ModelConfig.init_model">
<code class="sig-name descname">init_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em>, <em class="sig-param"><span class="n">state_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#ModelConfig.init_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.ModelConfig.init_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Instanciate the model and the optimizer.</p>
<p>If the model checkpoint <code class="docutils literal notranslate"><span class="pre">state_file</span></code> exists, the pretrained model and
optimizer states are loaded, otherwise the model and the optimizer are
initialized from scratch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>state_file</strong> (<cite>pathlib.Path</cite>) – Path to a model checkpoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>model</strong> (<cite>pysegcnn.core.models.Network</cite>) – An instance of <cite>pysegcnn.core.models.Network</cite>.</p></li>
<li><p><strong>optimizer</strong> (<cite>torch.optim.Optimizer</cite>) – An instance of <cite>torch.optim.Optimizer</cite>.</p></li>
<li><p><strong>checkpoint_state</strong> (<cite>dict</cite> [<cite>str</cite>, <cite>numpy.ndarray</cite>]) – If the model checkpoint <code class="docutils literal notranslate"><span class="pre">state_file</span></code> exists, <code class="docutils literal notranslate"><span class="pre">checkpoint_state</span></code>
has keys:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'ta'</span></code></dt><dd><p>The accuracy on the training set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tl'</span></code></dt><dd><p>The loss on the training set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'va'</span></code></dt><dd><p>The accuracy on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'vl'</span></code></dt><dd><p>The loss on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
</dl>
</div></blockquote>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="core.trainer.ModelConfig.init_optimizer">
<code class="sig-name descname">init_optimizer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#ModelConfig.init_optimizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.ModelConfig.init_optimizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Instanciate the optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> (<cite>torch.nn.Module</cite>) – An instance of <cite>torch.nn.Module</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>optimizer</strong> – An instance of <cite>torch.optim.Optimizer</cite>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>torch.optim.Optimizer</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.kwargs">
<code class="sig-name descname">kwargs</code><em class="property">: dict</em><a class="headerlink" href="#core.trainer.ModelConfig.kwargs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.ModelConfig.load_checkpoint">
<em class="property">static </em><code class="sig-name descname">load_checkpoint</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">model</span></em>, <em class="sig-param"><span class="n">optimizer</span></em>, <em class="sig-param"><span class="n">state_file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#ModelConfig.load_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.ModelConfig.load_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an existing model checkpoint.</p>
<p>If the model checkpoint <code class="docutils literal notranslate"><span class="pre">state_file</span></code> exists, the pretrained model and
optimizer states are loaded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<cite>pysegcnn.core.models.Network</cite>) – An instance of <cite>pysegcnn.core.models.Network</cite>.</p></li>
<li><p><strong>optimizer</strong> (<cite>torch.optim.Optimizer</cite>) – An instance of <cite>torch.optim.Optimizer</cite>.</p></li>
<li><p><strong>state_file</strong> (<cite>pathlib.Path</cite>) – Path to the model checkpoint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul>
<li><p><strong>model</strong> (<cite>pysegcnn.core.models.Network</cite>) – An instance of <cite>pysegcnn.core.models.Network</cite>.</p></li>
<li><p><strong>optimizer</strong> (<cite>torch.optim.Optimizer</cite>) – An instance of <cite>torch.optim.Optimizer</cite>.</p></li>
<li><p><strong>checkpoint_state</strong> (<cite>dict</cite> [<cite>str</cite>, <cite>numpy.ndarray</cite>]) – If the model checkpoint <code class="docutils literal notranslate"><span class="pre">state_file</span></code> exists, <code class="docutils literal notranslate"><span class="pre">checkpoint_state</span></code>
has keys:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'ta'</span></code></dt><dd><p>The accuracy on the training set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tl'</span></code></dt><dd><p>The loss on the training set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'va'</span></code></dt><dd><p>The accuracy on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'vl'</span></code></dt><dd><p>The loss on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
</dl>
</div></blockquote>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.loss_name">
<code class="sig-name descname">loss_name</code><em class="property">: str</em><a class="headerlink" href="#core.trainer.ModelConfig.loss_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.lr">
<code class="sig-name descname">lr</code><em class="property">: float</em><em class="property"> = 0.001</em><a class="headerlink" href="#core.trainer.ModelConfig.lr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.mode">
<code class="sig-name descname">mode</code><em class="property">: str</em><em class="property"> = 'max'</em><a class="headerlink" href="#core.trainer.ModelConfig.mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.model_name">
<code class="sig-name descname">model_name</code><em class="property">: str</em><a class="headerlink" href="#core.trainer.ModelConfig.model_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.nthreads">
<code class="sig-name descname">nthreads</code><em class="property">: int</em><em class="property"> = 2</em><a class="headerlink" href="#core.trainer.ModelConfig.nthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.optim_name">
<code class="sig-name descname">optim_name</code><em class="property">: str</em><a class="headerlink" href="#core.trainer.ModelConfig.optim_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.patience">
<code class="sig-name descname">patience</code><em class="property">: int</em><em class="property"> = 10</em><a class="headerlink" href="#core.trainer.ModelConfig.patience" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.pretrained_model">
<code class="sig-name descname">pretrained_model</code><em class="property">: str</em><em class="property"> = ''</em><a class="headerlink" href="#core.trainer.ModelConfig.pretrained_model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.save">
<code class="sig-name descname">save</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#core.trainer.ModelConfig.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.skip_connection">
<code class="sig-name descname">skip_connection</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#core.trainer.ModelConfig.skip_connection" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.torch_seed">
<code class="sig-name descname">torch_seed</code><em class="property">: int</em><a class="headerlink" href="#core.trainer.ModelConfig.torch_seed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.ModelConfig.transfer">
<code class="sig-name descname">transfer</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.ModelConfig.transfer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.ModelConfig.transfer_model">
<em class="property">static </em><code class="sig-name descname">transfer_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_file</span></em>, <em class="sig-param"><span class="n">ds</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#ModelConfig.transfer_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.ModelConfig.transfer_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust a pretrained model to a new dataset.</p>
<p>The classification layer of the pretrained model in <code class="docutils literal notranslate"><span class="pre">state_file</span></code> is
initilialized from scratch with the classes of the new dataset <code class="docutils literal notranslate"><span class="pre">ds</span></code>.</p>
<p>The remaining model weights are preserved.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_file</strong> (<cite>pathlib.Path</cite>) – Path to a pretrained model.</p></li>
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>TypeError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">ds</span></code> is not an instance of
<cite>pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>ValueError</strong> – Raised if the bands of <code class="docutils literal notranslate"><span class="pre">ds</span></code> do not match the bands of the dataset
the pretrained model was trained with.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>model</strong> – An instance of <cite>pysegcnn.core.models.Network</cite>. The pretrained model
adjusted to the new dataset.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pysegcnn.core.models.Network</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.trainer.NetworkTrainer">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">NetworkTrainer</code><span class="sig-paren">(</span><em class="sig-param">model: pysegcnn.core.models.Network</em>, <em class="sig-param">optimizer: torch.optim.optimizer.Optimizer</em>, <em class="sig-param">loss_function: torch.nn.modules.module.Module</em>, <em class="sig-param">train_dl: torch.utils.data.dataloader.DataLoader</em>, <em class="sig-param">valid_dl: torch.utils.data.dataloader.DataLoader</em>, <em class="sig-param">test_dl: torch.utils.data.dataloader.DataLoader</em>, <em class="sig-param">state_file: pathlib.Path</em>, <em class="sig-param">epochs: int = 1</em>, <em class="sig-param">nthreads: int = 2</em>, <em class="sig-param">early_stop: bool = False</em>, <em class="sig-param">mode: str = 'max'</em>, <em class="sig-param">delta: float = 0</em>, <em class="sig-param">patience: int = 10</em>, <em class="sig-param">checkpoint_state: dict = &lt;factory&gt;</em>, <em class="sig-param">save: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#NetworkTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.NetworkTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.trainer.BaseConfig" title="core.trainer.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.trainer.BaseConfig</span></code></a></p>
<p>Model training class.</p>
<p>Generic class to train an instance of <cite>pysegcnn.core.models.Network</cite> on
a dataset of type <cite>pysegcnn.core.dataset.ImageDataset</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<cite>pysegcnn.core.models.Network</cite>) – The model to train. An instance of <cite>pysegcnn.core.models.Network</cite>.</p></li>
<li><p><strong>optimizer</strong> (<cite>torch.optim.Optimizer</cite>) – The optimizer to update the model weights. An instance of
<cite>torch.optim.Optimizer</cite>.</p></li>
<li><p><strong>loss_function</strong> (<cite>torch.nn.Module</cite>) – The loss function to compute the model error. An instance of
<cite>torch.nn.Module</cite>.</p></li>
<li><p><strong>train_dl</strong> (<cite>torch.utils.data.DataLoader</cite>) – The training <cite>torch.utils.data.DataLoader</cite> instance.</p></li>
<li><p><strong>valid_dl</strong> (<cite>torch.utils.data.DataLoader</cite>) – The validation <cite>torch.utils.data.DataLoader</cite> instance.</p></li>
<li><p><strong>test_dl</strong> (<cite>torch.utils.data.DataLoader</cite>) – The test <cite>torch.utils.data.DataLoader</cite> instance.</p></li>
<li><p><strong>state_file</strong> (<cite>pathlib.Path</cite>) – Path to save the model state.</p></li>
<li><p><strong>epochs</strong> (<cite>int</cite>, optional) – The maximum number of epochs to train. The default is 1.</p></li>
<li><p><strong>nthreads</strong> (<cite>int</cite>, optional) – The number of cpu threads to use during training. The default is
torch.get_num_threads().</p></li>
<li><p><strong>early_stop</strong> (<cite>bool</cite>, optional) – Whether to apply <a href="#id29"><span class="problematic" id="id30">`early stopping`_</span></a>. The default is False.</p></li>
<li><p><strong>mode</strong> (<cite>str</cite>, optional) – The mode of the early stopping. Depends on the metric measuring
performance. When using model loss as metric, use <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘min’,
however, when using accuracy as metric, use <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘max’. For now,
only <code class="docutils literal notranslate"><span class="pre">mode</span></code> = ‘max’ is supported. Only used if <code class="docutils literal notranslate"><span class="pre">early_stop</span></code> = True.
The default is ‘max’.</p></li>
<li><p><strong>delta</strong> (<cite>float</cite>, optional) – Minimum change in early stopping metric to be considered as an
improvement. Only used if <code class="docutils literal notranslate"><span class="pre">early_stop</span></code> = True. The default is 0.</p></li>
<li><p><strong>patience</strong> (<cite>int</cite>, optional) – The number of epochs to wait for an improvement in the early stopping
metric. If the model does not improve over more than <code class="docutils literal notranslate"><span class="pre">patience</span></code>
epochs, quit training. Only used if <code class="docutils literal notranslate"><span class="pre">early_stop</span></code> = True.
The default is 10.</p></li>
<li><p><strong>checkpoint_state</strong> (<cite>dict</cite> [<cite>str</cite>, <cite>numpy.ndarray</cite>], optional) – <p>A model checkpoint for <code class="docutils literal notranslate"><span class="pre">model</span></code>. If specified, <code class="docutils literal notranslate"><span class="pre">checkpoint_state</span></code>
should be a dictionary with keys:</p>
<blockquote>
<div><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'ta'</span></code></dt><dd><p>The accuracy on the training set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'tl'</span></code></dt><dd><p>The loss on the training set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'va'</span></code></dt><dd><p>The accuracy on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'vl'</span></code></dt><dd><p>The loss on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
</dl>
</div></blockquote>
<p>The default is {}.</p>
</p></li>
<li><p><strong>save</strong> (<cite>bool</cite>, optional) – Whether to save the model state to <code class="docutils literal notranslate"><span class="pre">state_file</span></code>. The default is True.</p></li>
<li><p><strong>_early stopping</strong> (<em>.</em>) – <a class="reference external" href="https://en.wikipedia.org/wiki/Early_stopping">https://en.wikipedia.org/wiki/Early_stopping</a></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.NetworkTrainer.predict" title="core.trainer.NetworkTrainer.predict"><code class="xref py py-obj docutils literal notranslate"><span class="pre">predict</span></code></a>()</p></td>
<td><p>Model inference at training time.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.trainer.NetworkTrainer.save_state" title="core.trainer.NetworkTrainer.save_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_state</span></code></a>()</p></td>
<td><p>Save the model state.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.NetworkTrainer.train" title="core.trainer.NetworkTrainer.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a>()</p></td>
<td><p>Train the model.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.checkpoint_state">
<code class="sig-name descname">checkpoint_state</code><em class="property">: dict</em><a class="headerlink" href="#core.trainer.NetworkTrainer.checkpoint_state" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.delta">
<code class="sig-name descname">delta</code><em class="property">: float</em><em class="property"> = 0</em><a class="headerlink" href="#core.trainer.NetworkTrainer.delta" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.early_stop">
<code class="sig-name descname">early_stop</code><em class="property">: bool</em><em class="property"> = False</em><a class="headerlink" href="#core.trainer.NetworkTrainer.early_stop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.epochs">
<code class="sig-name descname">epochs</code><em class="property">: int</em><em class="property"> = 1</em><a class="headerlink" href="#core.trainer.NetworkTrainer.epochs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.loss_function">
<code class="sig-name descname">loss_function</code><em class="property">: torch.nn.modules.module.Module</em><a class="headerlink" href="#core.trainer.NetworkTrainer.loss_function" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.mode">
<code class="sig-name descname">mode</code><em class="property">: str</em><em class="property"> = 'max'</em><a class="headerlink" href="#core.trainer.NetworkTrainer.mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.model">
<code class="sig-name descname">model</code><em class="property">: pysegcnn.core.models.Network</em><a class="headerlink" href="#core.trainer.NetworkTrainer.model" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.nthreads">
<code class="sig-name descname">nthreads</code><em class="property">: int</em><em class="property"> = 2</em><a class="headerlink" href="#core.trainer.NetworkTrainer.nthreads" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.optimizer">
<code class="sig-name descname">optimizer</code><em class="property">: torch.optim.optimizer.Optimizer</em><a class="headerlink" href="#core.trainer.NetworkTrainer.optimizer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.patience">
<code class="sig-name descname">patience</code><em class="property">: int</em><em class="property"> = 10</em><a class="headerlink" href="#core.trainer.NetworkTrainer.patience" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.NetworkTrainer.predict">
<code class="sig-name descname">predict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#NetworkTrainer.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.NetworkTrainer.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Model inference at training time.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>accuracies</strong> (<cite>numpy.ndarray</cite>) – The mean model prediction accuracy on each mini-batch in the
validation set.</p></li>
<li><p><strong>losses</strong> (<cite>numpy.ndarray</cite>) – The model loss for each mini-batch in the validation set.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.save">
<code class="sig-name descname">save</code><em class="property">: bool</em><em class="property"> = True</em><a class="headerlink" href="#core.trainer.NetworkTrainer.save" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.NetworkTrainer.save_state">
<code class="sig-name descname">save_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#NetworkTrainer.save_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.NetworkTrainer.save_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the model state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.state_file">
<code class="sig-name descname">state_file</code><em class="property">: pathlib.Path</em><a class="headerlink" href="#core.trainer.NetworkTrainer.state_file" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.test_dl">
<code class="sig-name descname">test_dl</code><em class="property">: torch.utils.data.dataloader.DataLoader</em><a class="headerlink" href="#core.trainer.NetworkTrainer.test_dl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.NetworkTrainer.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#NetworkTrainer.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.NetworkTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>training_state</strong> – The training state dictionary with keys:
<code class="docutils literal notranslate"><span class="pre">'ta'</span></code></p>
<blockquote>
<div><p>The accuracy on the training set (<cite>numpy.ndarray</cite>).</p>
</div></blockquote>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'tl'</span></code></dt><dd><p>The loss on the training set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'va'</span></code></dt><dd><p>The accuracy on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">'vl'</span></code></dt><dd><p>The loss on the validation set (<cite>numpy.ndarray</cite>).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite> [<cite>str</cite>, <cite>numpy.ndarray</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.train_dl">
<code class="sig-name descname">train_dl</code><em class="property">: torch.utils.data.dataloader.DataLoader</em><a class="headerlink" href="#core.trainer.NetworkTrainer.train_dl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.NetworkTrainer.valid_dl">
<code class="sig-name descname">valid_dl</code><em class="property">: torch.utils.data.dataloader.DataLoader</em><a class="headerlink" href="#core.trainer.NetworkTrainer.valid_dl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.trainer.SplitConfig">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">SplitConfig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">split_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">ttratio</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">tvratio</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">date</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'yyyymmdd'</span></em>, <em class="sig-param"><span class="n">dateformat</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'%Y%m%d'</span></em>, <em class="sig-param"><span class="n">drop</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#SplitConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.SplitConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.trainer.BaseConfig" title="core.trainer.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.trainer.BaseConfig</span></code></a></p>
<p>Dataset split configuration class.</p>
<p>Split a dataset into training, validation and test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>split_mode</strong> (<cite>str</cite>) – The mode to split the dataset.</p></li>
<li><p><strong>ttratio</strong> (<cite>float</cite>) – The ratio of training and validation data to test data, e.g.
<code class="docutils literal notranslate"><span class="pre">ttratio</span></code> = 0.6 means 60% for training and validation, 40% for
testing.</p></li>
<li><p><strong>tvratio</strong> (<cite>float</cite>) – The ratio of training data to validation data, e.g. <code class="docutils literal notranslate"><span class="pre">tvratio</span></code> = 0.8
means 80% training, 20% validation.</p></li>
<li><p><strong>date</strong> (<cite>str</cite>, optional) – A date. Used if <code class="docutils literal notranslate"><span class="pre">split_mode</span></code> = ‘date’. The default is ‘yyyymmdd’.</p></li>
<li><p><strong>dateformat</strong> (<cite>str</cite>, optional) – The format of <code class="docutils literal notranslate"><span class="pre">date</span></code>. <code class="docutils literal notranslate"><span class="pre">dateformat</span></code> is used by
<cite>datetime.datetime.strptime’ to parse ``date`</cite> to a <cite>datetime.datetime</cite>
object. The default is ‘%Y%m%d’.</p></li>
<li><p><strong>drop</strong> (<cite>float</cite>, optional) – Whether to drop samples (during training only) with a fraction of
pixels equal to the constant padding value &gt;= <code class="docutils literal notranslate"><span class="pre">drop</span></code>. <code class="docutils literal notranslate"><span class="pre">drop</span></code> = 0
means, do not drop any samples. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.SplitConfig.dataloaders" title="core.trainer.SplitConfig.dataloaders"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dataloaders</span></code></a>(*args, **kwargs)</p></td>
<td><p>Build <cite>torch.utils.data.DataLoader</cite> instances.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#core.trainer.SplitConfig.train_val_test_split" title="core.trainer.SplitConfig.train_val_test_split"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train_val_test_split</span></code></a>(ds)</p></td>
<td><p>Split <code class="docutils literal notranslate"><span class="pre">ds</span></code> into training, validation and test set.</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="core.trainer.SplitConfig.dataloaders">
<em class="property">static </em><code class="sig-name descname">dataloaders</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#SplitConfig.dataloaders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.SplitConfig.dataloaders" title="Permalink to this definition">¶</a></dt>
<dd><p>Build <cite>torch.utils.data.DataLoader</cite> instances.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> (<cite>list</cite> [<cite>torch.utils.data.Dataset</cite>]) – List of instances of <cite>torch.utils.data.Dataset</cite>.</p></li>
<li><p><strong>**kwargs</strong> – Additional keyword arguments passed to
<cite>torch.utils.data.DataLoader</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – Raised if not each item in <code class="docutils literal notranslate"><span class="pre">args</span></code> is an instance of
<cite>torch.utils.data.Dataset</cite>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>loaders</strong> – List of instances of <cite>torch.utils.data.DataLoader</cite>. If an instance
of <cite>torch.utils.data.Dataset</cite> in <code class="docutils literal notranslate"><span class="pre">args</span></code> is empty, <cite>None</cite> is
appended to <code class="docutils literal notranslate"><span class="pre">loaders</span></code> instead of an instance of
<cite>torch.utils.data.DataLoader</cite>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>list</cite> [<cite>torch.utils.data.DataLoader</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.SplitConfig.date">
<code class="sig-name descname">date</code><em class="property">: str</em><em class="property"> = 'yyyymmdd'</em><a class="headerlink" href="#core.trainer.SplitConfig.date" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.SplitConfig.dateformat">
<code class="sig-name descname">dateformat</code><em class="property">: str</em><em class="property"> = '%Y%m%d'</em><a class="headerlink" href="#core.trainer.SplitConfig.dateformat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.SplitConfig.drop">
<code class="sig-name descname">drop</code><em class="property">: float</em><em class="property"> = 0</em><a class="headerlink" href="#core.trainer.SplitConfig.drop" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.SplitConfig.split_mode">
<code class="sig-name descname">split_mode</code><em class="property">: str</em><a class="headerlink" href="#core.trainer.SplitConfig.split_mode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.SplitConfig.train_val_test_split">
<code class="sig-name descname">train_val_test_split</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#SplitConfig.train_val_test_split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.SplitConfig.train_val_test_split" title="Permalink to this definition">¶</a></dt>
<dd><p>Split <code class="docutils literal notranslate"><span class="pre">ds</span></code> into training, validation and test set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>pysegcnn.core.dataset.ImageDataset</cite>.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>TypeError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">ds</span></code> is not an instance of
<cite>pysegcnn.core.dataset.ImageDataset</cite>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>train_ds</strong> (<cite>pysegcnn.core.split.RandomSubset</cite> or)</p></li>
<li><p><cite>pysegcnn.core.split.SceneSubset</cite>. – The training set.</p></li>
<li><p><strong>valid_ds</strong> (<cite>pysegcnn.core.split.RandomSubset</cite> or)</p></li>
<li><p><cite>pysegcnn.core.split.SceneSubset</cite>. – The validation set.</p></li>
<li><p><strong>test_ds</strong> (<cite>pysegcnn.core.split.RandomSubset</cite> or)</p></li>
<li><p><cite>pysegcnn.core.split.SceneSubset</cite>. – The test set.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.SplitConfig.ttratio">
<code class="sig-name descname">ttratio</code><em class="property">: float</em><a class="headerlink" href="#core.trainer.SplitConfig.ttratio" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.SplitConfig.tvratio">
<code class="sig-name descname">tvratio</code><em class="property">: float</em><a class="headerlink" href="#core.trainer.SplitConfig.tvratio" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.trainer.StateConfig">
<em class="property">class </em><code class="sig-prename descclassname">core.trainer.</code><code class="sig-name descname">StateConfig</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ds</span><span class="p">:</span> <span class="n">pysegcnn.core.dataset.ImageDataset</span></em>, <em class="sig-param"><span class="n">sc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#core.trainer.SplitConfig" title="core.trainer.SplitConfig">core.trainer.SplitConfig</a></span></em>, <em class="sig-param"><span class="n">mc</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#core.trainer.ModelConfig" title="core.trainer.ModelConfig">core.trainer.ModelConfig</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#StateConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.StateConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.trainer.BaseConfig" title="core.trainer.BaseConfig"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.trainer.BaseConfig</span></code></a></p>
<p>Model state configuration class.</p>
<p>Generate the model state filename according to the following naming
convention:</p>
<p>model_dataset_optimizer_splitmode_splitparams_tilesize_batchsize_bands.pt</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<cite>pysegcnn.core.dataset.ImageDataset</cite>) – An instance of <cite>pysegcnn.core.dataset.ImageDataset</cite>.</p></li>
<li><p><strong>sc</strong> (<cite>pysegcnn.core.trainer.SplitConfig</cite>) – An instance of <cite>pysegcnn.core.trainer.SplitConfig</cite>.</p></li>
<li><p><strong>mc</strong> (<cite>pysegcnn.core.trainer.ModelConfig</cite>) – An instance of <cite>pysegcnn.core.trainer.SplitConfig</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#core.trainer.StateConfig.init_state" title="core.trainer.StateConfig.init_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">init_state</span></code></a>()</p></td>
<td><p>Generate the model state filename.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="core.trainer.StateConfig.ds">
<code class="sig-name descname">ds</code><em class="property">: pysegcnn.core.dataset.ImageDataset</em><a class="headerlink" href="#core.trainer.StateConfig.ds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="core.trainer.StateConfig.init_state">
<code class="sig-name descname">init_state</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/trainer.html#StateConfig.init_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.trainer.StateConfig.init_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate the model state filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>state</strong> – The path to the model state file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>pathlib.Path</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="core.trainer.StateConfig.mc">
<code class="sig-name descname">mc</code><em class="property">: <a class="reference internal" href="#core.trainer.ModelConfig" title="core.trainer.ModelConfig">core.trainer.ModelConfig</a></em><a class="headerlink" href="#core.trainer.StateConfig.mc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="core.trainer.StateConfig.sc">
<code class="sig-name descname">sc</code><em class="property">: <a class="reference internal" href="#core.trainer.SplitConfig" title="core.trainer.SplitConfig">core.trainer.SplitConfig</a></em><a class="headerlink" href="#core.trainer.StateConfig.sc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-core.transforms">
<span id="core-transforms-module"></span><h2>core.transforms module<a class="headerlink" href="#module-core.transforms" title="Permalink to this headline">¶</a></h2>
<p>Data augmentation.</p>
<p>This module provides classes implementing common image augmentation methods.</p>
<p>These methods may be used to artificially increase a dataset.</p>
<div class="section" id="id11">
<h3>License<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py class">
<dt id="core.transforms.Augment">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">Augment</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">transforms</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/transforms.html#Augment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.Augment" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Apply a sequence of transformations.</p>
<p>Container class applying each transformation in <code class="docutils literal notranslate"><span class="pre">transforms</span></code> in order.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transforms</strong> (<cite>list</cite> or <cite>tuple</cite>) – A sequence of instances of <cite>pysegcnn.core.transforms.VariantTransform</cite>
or <cite>pysegcnn.core.transforms.InvariantTransform</cite>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image, gt)</p></td>
<td><p>Apply a sequence of transformations to <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="core.transforms.FlipLr">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">FlipLr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/transforms.html#FlipLr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.FlipLr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.transforms.VariantTransform" title="core.transforms.VariantTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.transforms.VariantTransform</span></code></a></p>
<p>Flip an image horizontally.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> (<cite>float</cite>, optional) – The probability to apply the transformation. The default is 0.5.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image)</p></td>
<td><p>Apply transformation.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="core.transforms.FlipUd">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">FlipUd</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/transforms.html#FlipUd"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.FlipUd" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.transforms.VariantTransform" title="core.transforms.VariantTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.transforms.VariantTransform</span></code></a></p>
<p>Flip an image vertically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>p</strong> (<cite>float</cite>, optional) – The probability to apply the transformation. The default is 0.5.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image)</p></td>
<td><p>Apply transformation.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="core.transforms.InvariantTransform">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">InvariantTransform</code><a class="reference internal" href="../_modules/core/transforms.html#InvariantTransform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.InvariantTransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.transforms.Transform" title="core.transforms.Transform"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.transforms.Transform</span></code></a></p>
<p>Base class for a spatially invariant transformation.</p>
<p>Transformation on the ground truth not required.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image)</p></td>
<td><p>Apply transformation.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="core.transforms.Noise">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">Noise</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mode</span></em>, <em class="sig-param"><span class="n">mean</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">var</span><span class="o">=</span><span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">exclude</span><span class="o">=</span><span class="default_value">[]</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/transforms.html#Noise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.Noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.transforms.InvariantTransform" title="core.transforms.InvariantTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.transforms.InvariantTransform</span></code></a></p>
<p>Add gaussian noise to an image.</p>
<p>Valid modes are:</p>
<blockquote>
<div><p>‘add’: image = image + noise
‘speckle’ : image = image + image * noise</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong> (<cite>str</cite>) – The mode to add the noise.</p></li>
<li><p><strong>mean</strong> (<cite>float</cite>, optional) – The mean of the gaussian distribution from which the noise is sampled.
The default is 0.</p></li>
<li><p><strong>var</strong> (<cite>float</cite>, optional) – The variance of the gaussian distribution from which the noise is
sampled. The default is 0.05.</p></li>
<li><p><strong>p</strong> (<cite>float</cite>, optional) – The probability to apply the transformation. The default is 0.5.</p></li>
<li><p><strong>exclude</strong> (<cite>list</cite> [<cite>float</cite>] or <cite>list</cite> [<cite>int</cite>], optional) – Values for which the noise is not added. Useful for pixels resulting
from image padding. The default is [].</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">mode</span></code> is not supported.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image)</p></td>
<td><p>Apply transformation.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt id="core.transforms.Noise.modes">
<code class="sig-name descname">modes</code><em class="property"> = ['add', 'speckle']</em><a class="headerlink" href="#core.transforms.Noise.modes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="core.transforms.Rotate">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">Rotate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">angle</span></em>, <em class="sig-param"><span class="n">p</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/transforms.html#Rotate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.Rotate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.transforms.VariantTransform" title="core.transforms.VariantTransform"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.transforms.VariantTransform</span></code></a></p>
<p>Rotate an image by <code class="docutils literal notranslate"><span class="pre">angle</span></code>.</p>
<p>The image is rotated in the spatial plane.</p>
<p>If the input array has more then two dimensions, the spatial dimensions are
assumed to be the last two dimensions of the array.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>angle</strong> (<cite>float</cite>) – The rotation angle in degrees.</p></li>
<li><p><strong>p</strong> (<cite>float</cite>, optional) – The probability to apply the transformation. The default is 0.5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image)</p></td>
<td><p>Apply transformation.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="core.transforms.Transform">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">Transform</code><a class="reference internal" href="../_modules/core/transforms.html#Transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.Transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for an image transformation.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image)</p></td>
<td><p>Apply transformation.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="py class">
<dt id="core.transforms.VariantTransform">
<em class="property">class </em><code class="sig-prename descclassname">core.transforms.</code><code class="sig-name descname">VariantTransform</code><a class="reference internal" href="../_modules/core/transforms.html#VariantTransform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.transforms.VariantTransform" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#core.transforms.Transform" title="core.transforms.Transform"><code class="xref py py-class docutils literal notranslate"><span class="pre">core.transforms.Transform</span></code></a></p>
<p>Base class for a spatially variant transformation.</p>
<p>Transformation on the ground truth required.</p>
<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">__call__</span></code>(image)</p></td>
<td><p>Apply transformation.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-core.utils">
<span id="core-utils-module"></span><h2>core.utils module<a class="headerlink" href="#module-core.utils" title="Permalink to this headline">¶</a></h2>
<p>Utility functions mainly for image IO and reshaping.</p>
<div class="section" id="id12">
<h3>License<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><p>Copyright (c) 2020 Daniel Frisinghelli</p>
<p>This source code is licensed under the GNU General Public License v3.</p>
<p>See the LICENSE file in the repository’s root directory.</p>
</div></blockquote>
<dl class="py function">
<dt id="core.utils.accuracy_function">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">accuracy_function</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outputs</span></em>, <em class="sig-param"><span class="n">labels</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#accuracy_function"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.accuracy_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate prediction accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>outputs</strong> (<cite>torch.Tensor</cite> or array_like) – The model prediction.</p></li>
<li><p><strong>labels</strong> (<cite>torch.Tensor</cite> or array_like) – The ground truth.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>accuracy</strong> – Mean prediction accuracy.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.check_tile_extend">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">check_tile_extend</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img_size</span></em>, <em class="sig-param"><span class="n">topleft</span></em>, <em class="sig-param"><span class="n">tile_size</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#check_tile_extend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.check_tile_extend" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a tile exceeds the image size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<cite>tuple</cite>) – The image size (height, width).</p></li>
<li><p><strong>topleft</strong> (<cite>tuple</cite>) – The topleft corner of the tile (y, x).</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite>) – The size of the tile.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>nrows</strong> (<cite>int</cite>) – Number of rows of the tile within the image.</p></li>
<li><p><strong>ncols</strong> (<em>TYPE</em>) – Number of columns of the tile within the image.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.destack_tiff">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">destack_tiff</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">image</span></em>, <em class="sig-param"><span class="n">outpath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">remove</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="o">=</span><span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#destack_tiff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.destack_tiff" title="Permalink to this definition">¶</a></dt>
<dd><p>Destack a TIFF with more than one band into a TIFF file for each band.</p>
<p>Each band in <code class="docutils literal notranslate"><span class="pre">image</span></code> is saved to <code class="docutils literal notranslate"><span class="pre">outpath</span></code> as distinct TIFF file.
The default filenames are: “filename(<code class="docutils literal notranslate"><span class="pre">image</span></code>) + _B(i).tif”, where i is
the respective number of each band in <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – The TIFF to destack.</p></li>
<li><p><strong>outpath</strong> (<cite>str</cite>, optional) – Path to save the output TIFF files. The default is None. If None,
<code class="docutils literal notranslate"><span class="pre">outpath</span></code> is the path to <code class="docutils literal notranslate"><span class="pre">image</span></code>.</p></li>
<li><p><strong>remove</strong> (<cite>bool</cite>, optional) – Whether to remove <code class="docutils literal notranslate"><span class="pre">image</span></code> from disk after destacking. The default is
False.</p></li>
<li><p><strong>overwrite</strong> (<cite>bool</cite>, optional) – Whether to overwrite existing TIFF files.</p></li>
<li><p><strong>suffix</strong> (<cite>str</cite>, optional) – String to append to the filename of <code class="docutils literal notranslate"><span class="pre">image</span></code>. If specified, the TIFF
filenames for each band in <code class="docutils literal notranslate"><span class="pre">image</span></code> are, “filename(<code class="docutils literal notranslate"><span class="pre">image</span></code>) +
+ _B(i)_ + <code class="docutils literal notranslate"><span class="pre">suffix</span></code>.tif”. The default is ‘’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">image</span></code> does not exist.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.doy2date">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">doy2date</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">year</span></em>, <em class="sig-param"><span class="n">doy</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#doy2date"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.doy2date" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert the (year, day of the year) date format to a datetime object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>year</strong> (<cite>int</cite>) – The year</p></li>
<li><p><strong>doy</strong> (<cite>int</cite>) – The day of the year</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>date</strong> – The converted date.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>datetime.datetime</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.extract_archive">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">extract_archive</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inpath</span></em>, <em class="sig-param"><span class="n">outpath</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#extract_archive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.extract_archive" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract files from an archive.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inpath</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – Path to an archive.</p></li>
<li><p><strong>outpath</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – Path to save extracted files.</p></li>
<li><p><strong>overwrite</strong> (<cite>bool</cite>, optional) – Whether to overwrite existing extracted files.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>subdir</strong> – path to the extracted files</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.get_radiometric_constants">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">get_radiometric_constants</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">metadata</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#get_radiometric_constants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.get_radiometric_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve the radiometric calibration constants.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metadata</strong> (<cite>dict</cite>) – The dictionary returned by <code class="docutils literal notranslate"><span class="pre">read_landsat_metadata</span></code>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>oli</strong> (<cite>dict</cite>) – Radiometric rescaling factors of the OLI sensor.</p></li>
<li><p><strong>tir</strong> (<cite>dict</cite>) – Thermal conversion constants of the TIRS sensor.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.img2np">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">img2np</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span></em>, <em class="sig-param"><span class="n">tile_size</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">tile</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">cval</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#img2np"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.img2np" title="Permalink to this definition">¶</a></dt>
<dd><p>Read an image to a <cite>numpy.ndarray</cite>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">tile_size</span></code> is not <cite>None</cite>, the input image is divided into square
tiles of size (<code class="docutils literal notranslate"><span class="pre">tile_size</span></code>, <code class="docutils literal notranslate"><span class="pre">tile_size</span></code>). If the image is not evenly
divisible and <code class="docutils literal notranslate"><span class="pre">pad</span></code> = False, a <cite>ValueError</cite> is raised. However, if
<code class="docutils literal notranslate"><span class="pre">pad</span></code> = True, center padding with constant value <code class="docutils literal notranslate"><span class="pre">cval</span></code> is applied.</p>
<p>The tiling works as follows:</p>
<blockquote>
<div><p>(Padded) Input image:</p>
<div class="line-block">
<div class="line-block">
<div class="line">|           |          |           |</div>
</div>
<div class="line">tile_00  |  tile_01  |    …   |  tile_0n  |</div>
<div class="line-block">
<div class="line">|           |          |           |</div>
</div>
</div>
<p><a href="#id17"><span class="problematic" id="id18">|----------------------------------------------|</span></a>
|           |           |          |           |
|  tile_10  |  tile_11  |    …   |  tile_1n  |
|           |           |          |           |
<a href="#id19"><span class="problematic" id="id20">|----------------------------------------------|</span></a>
|           |           |          |           |
|    …    |    …    |    …   |    …    |
|           |           |          |           |
<a href="#id21"><span class="problematic" id="id22">|----------------------------------------------|</span></a>
|           |           |          |           |
|  tile_m0  |  tile_m1  |    …   |  tile_mn  |
|           |           |          |           |
————————————————</p>
</div></blockquote>
<p>where m = n. Each tile has its id, which starts at 0 in the topleft corner
of the input image, i.e. tile_00 has id=0, and increases along the width
axis, i.e. tile_0n has id=n, tile_10 has id=n+1, …, tile_mn has
id=(m * n) - 1.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">tile</span></code> is an integer, only the tile with id = <code class="docutils literal notranslate"><span class="pre">tile</span></code> is returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> (<cite>str</cite> or <cite>None</cite> or <cite>numpy.ndarray</cite>) – The image to read.</p></li>
<li><p><strong>tile_size</strong> (<cite>None</cite> or <cite>int</cite>, optional) – The size of a tile. The default is None.</p></li>
<li><p><strong>tile</strong> (<cite>int</cite>, optional) – The tile id. The default is None.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. The default is False.</p></li>
<li><p><strong>cval</strong> (<cite>float</cite>, optional) – The constant padding value. The default is 0.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">path</span></code> is a path that does not exist.</p></li>
<li><p><strong>TypeError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">path</span></code> is not <cite>str</cite> or <cite>None</cite> or <cite>numpy.ndarray</cite>.</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><p><strong>image</strong> –</p>
<p>The image array. The output shape is:</p>
<blockquote>
<div><dl>
<dt>if <code class="docutils literal notranslate"><span class="pre">tile_size</span></code> is not <cite>None</cite>:</dt><dd><p>shape=(tiles, bands, tile_size, tile_size)
if the image does only have one band:</p>
<blockquote>
<div><p>shape=(tiles, tile_size, tile_size)</p>
</div></blockquote>
</dd>
<dt>else:</dt><dd><p>shape=(bands, height, width)
if the image does only have one band:</p>
<blockquote>
<div><p>shape=(height, width)</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.is_divisible">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">is_divisible</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img_size</span></em>, <em class="sig-param"><span class="n">tile_size</span></em>, <em class="sig-param"><span class="n">pad</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#is_divisible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.is_divisible" title="Permalink to this definition">¶</a></dt>
<dd><p>Check whether an image is evenly divisible into square tiles.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<cite>tuple</cite>) – The image size (height, width).</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite>) – The size of the tile.</p></li>
<li><p><strong>pad</strong> (<cite>bool</cite>, optional) – Whether to center pad the input image. The default is False.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if the image is not evenly divisible and <code class="docutils literal notranslate"><span class="pre">pad</span></code> = False.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>ntiles</strong> (<cite>int</cite>) – The number of tiles fitting <code class="docutils literal notranslate"><span class="pre">img_size</span></code>.</p></li>
<li><p><strong>padding</strong> (<cite>tuple</cite>) – The amount of padding (bottom, left, top, right).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.item_in_enum">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">item_in_enum</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">enum</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#item_in_enum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.item_in_enum" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an item exists in an enumeration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – Name of the item.</p></li>
<li><p><strong>enum</strong> (<cite>enum.Enum</cite>) – An instance of <cite>enum.Enum</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">name</span></code> is not in <code class="docutils literal notranslate"><span class="pre">enum</span></code>.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The value of <code class="docutils literal notranslate"><span class="pre">name</span></code> in <code class="docutils literal notranslate"><span class="pre">enum</span></code>.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.landsat_radiometric_calibration">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">landsat_radiometric_calibration</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene</span></em>, <em class="sig-param"><span class="n">outpath</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">exclude</span><span class="o">=</span><span class="default_value">[]</span></em>, <em class="sig-param"><span class="n">radiance</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">overwrite</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">remove_raw</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#landsat_radiometric_calibration"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.landsat_radiometric_calibration" title="Permalink to this definition">¶</a></dt>
<dd><p>Radiometric calibration of Landsat Collection Level 1 scenes.</p>
<p>Convert the Landsat OLI bands to top of atmosphere radiance or reflectance
and the TIRS bands to top of atmosphere brightness temperature.</p>
<p>Conversion is performed following the <a href="#id31"><span class="problematic" id="id32">`equations`_</span></a> provided by the USGS.</p>
<p>The filename of each band is extended by one of the following suffixes,
depending on the type of the radiometric calibration:</p>
<blockquote>
<div><p>‘toa_ref’: top of atmosphere reflectance
‘toa_rad’: top of atmopshere radiance
‘toa_brt’: top of atmosphere brightness temperature</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scene</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – Path to a Landsat scene in digital number format.</p></li>
<li><p><strong>outpath</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>, optional) – Path to save the calibrated images. The default is None, which means
saving to <code class="docutils literal notranslate"><span class="pre">scene</span></code>.</p></li>
<li><p><strong>exclude</strong> (<cite>list</cite> [<cite>str</cite>], optional) – Bands to exclude from the radiometric calibration. The default is [].</p></li>
<li><p><strong>radiance</strong> (<cite>bool</cite>, optional) – Whether to calculate top of atmosphere radiance. The default is False,
which means calculating top of atmopshere reflectance.</p></li>
<li><p><strong>overwrite</strong> (<cite>bool</cite>, optional) – Whether to overwrite the calibrated images. The default is False.</p></li>
<li><p><strong>remove_raw</strong> (<cite>bool</cite>, optional) – Whether to remove the raw digitial number images. The default is True.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">scene</span></code> does not exist.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><em>None.</em></p></li>
<li><p><em>.. _equations</em> – <a class="reference external" href="https://www.usgs.gov/land-resources/nli/landsat/using-usgs-landsat-level-1-data-product">https://www.usgs.gov/land-resources/nli/landsat/using-usgs-landsat-level-1-data-product</a></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.parse_landsat_scene">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">parse_landsat_scene</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#parse_landsat_scene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.parse_landsat_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a Landsat scene identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene_id</strong> (<cite>str</cite>) – A Landsat scene identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scene</strong> – A dictionary containing scene metadata. If <cite>None</cite>, <code class="docutils literal notranslate"><span class="pre">scene_id</span></code> is not
a valid Landsat scene identifier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite> or <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.parse_sentinel2_scene">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">parse_sentinel2_scene</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">scene_id</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#parse_sentinel2_scene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.parse_sentinel2_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse a Sentinel-2 scene identifier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>scene_id</strong> (<cite>str</cite>) – A Sentinel-2 scene identifier.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>scene</strong> – A dictionary containing scene metadata. If <cite>None</cite>, <code class="docutils literal notranslate"><span class="pre">scene_id</span></code> is not
a valid Sentinel-2 scene identifier.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite> or <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.read_landsat_metadata">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">read_landsat_metadata</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">file</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#read_landsat_metadata"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.read_landsat_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the Landsat metadata <a href="#id13"><span class="problematic" id="id14">*</span></a>_MTL.txt file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – Path to a Landsat <a href="#id15"><span class="problematic" id="id16">*</span></a>_MTL.txt file.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>FileNotFoundError</strong> – Raised if <code class="docutils literal notranslate"><span class="pre">file</span></code> does not exist.</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>metadata</strong> – The metadata text file as dictionary, where each line is a (key, value)
pair.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.reconstruct_scene">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">reconstruct_scene</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tiles</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#reconstruct_scene"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.reconstruct_scene" title="Permalink to this definition">¶</a></dt>
<dd><p>Reconstruct a tiled image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tiles</strong> (<cite>torch.Tensor</cite> or <cite>numpy.ndarray</cite>) – The tiled image, shape=(tiles, bands, tile_size, tile_size) or
shape=(tiles, tile_size, tile_size).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>image</strong> – The reconstructed image.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>numpy.ndarray</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.standard_eo_structure">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">standard_eo_structure</code><span class="sig-paren">(</span><em class="sig-param">source_path</em>, <em class="sig-param">target_path</em>, <em class="sig-param">overwrite=False</em>, <em class="sig-param">move=False</em>, <em class="sig-param">parser=&lt;function parse_landsat_scene&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#standard_eo_structure"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.standard_eo_structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Modify the directory structure of a remote sensing dataset.</p>
<p>This function assumes that <code class="docutils literal notranslate"><span class="pre">source_path</span></code> points to a directory containing
remote sensing data, where each file in <code class="docutils literal notranslate"><span class="pre">source_path</span></code> and its sub-folders
should contain a scene identifier in its filename. The scene identifier is
used to restructure the dataset.</p>
<p>Currently, Landsat and Sentinel-2 datasets are supported.</p>
<p>The directory tree in <code class="docutils literal notranslate"><span class="pre">source_path</span></code> is modified to the following
structure in <code class="docutils literal notranslate"><span class="pre">target_path</span></code>:</p>
<blockquote>
<div><dl>
<dt>target_path/</dt><dd><dl class="simple">
<dt>scene_id_1/</dt><dd><p>files matching scene_id_1</p>
</dd>
<dt>scene_id_2/</dt><dd><p>files matching scene_id_2</p>
</dd>
</dl>
<p>.
scene_id_n/</p>
<blockquote>
<div><p>files matching scene_id_n</p>
</div></blockquote>
</dd>
</dl>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_path</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – Path to the remote sensing dataset.</p></li>
<li><p><strong>target_path</strong> (<cite>str</cite> or <cite>pathlib.Path</cite>) – Path to save the restructured dataset.</p></li>
<li><p><strong>overwrite</strong> (<cite>bool</cite>, optional) – Whether to overwrite existing files in <code class="docutils literal notranslate"><span class="pre">target_path</span></code>.
The default is True.</p></li>
<li><p><strong>move</strong> (<cite>bool</cite>, optional) – Whether to move the files from <code class="docutils literal notranslate"><span class="pre">source_path</span></code> to <code class="docutils literal notranslate"><span class="pre">target_path</span></code>. If
True, files in <code class="docutils literal notranslate"><span class="pre">source_path</span></code> are moved to <code class="docutils literal notranslate"><span class="pre">target_path</span></code>, if False,
files in <code class="docutils literal notranslate"><span class="pre">source_path</span></code> are copied to <code class="docutils literal notranslate"><span class="pre">target_path</span></code>. The default is
False.</p></li>
<li><p><strong>parser</strong> (<cite>function</cite>, optional) – The scene identifier parsing function. Depends on the sensor of the
dataset. See e.g., <cite>pysegcnn.core.utils.parse_landsat_scene</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="core.utils.tile_topleft_corner">
<code class="sig-prename descclassname">core.utils.</code><code class="sig-name descname">tile_topleft_corner</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">img_size</span></em>, <em class="sig-param"><span class="n">tile_size</span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/core/utils.html#tile_topleft_corner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#core.utils.tile_topleft_corner" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the topleft corners of the tiles in the image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>img_size</strong> (<cite>tuple</cite>) – The image size (height, width).</p></li>
<li><p><strong>tile_size</strong> (<cite>int</cite>) – The size of the tile.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>indices</strong> – The keys of <code class="docutils literal notranslate"><span class="pre">indices</span></code> are the tile ids (<cite>int</cite>) and the values are the
topleft corners (<cite>tuple</cite> = (y, x)) of the tiles.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-core" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="main.html" class="btn btn-neutral float-right" title="main package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="modules.html" class="btn btn-neutral float-left" title="pysegcnn" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Daniel Frisinghelli

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>